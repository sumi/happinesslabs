
			// File : /okcontent/js/scriptaculous-1.8.1-for-autocore/controls.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/scriptaculous-1.8.1-for-autocore/controls.js";
			
var Autocompleter={}
Autocompleter.Base=Class.create({baseInitialize:function(element,update,options){element=$(element)
this.element=element;this.update=$(update);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;if(this.setOptions)
this.setOptions(options);else
this.options=options||{};this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(element,update){if(!update.style.position||update.style.position=='absolute'){update.style.position='absolute';Position.clone(element,update,{setHeight:false,offsetTop:element.offsetHeight});}
Effect.Appear(update,{duration:0.15});};this.options.onHide=this.options.onHide||function(element,update){new Effect.Fade(update,{duration:0.15})};if(typeof(this.options.tokens)=='string')
this.options.tokens=new Array(this.options.tokens);if(!this.options.tokens.include('\n'))
this.options.tokens.push('\n');this.observer=null;this.element.setAttribute('autocomplete','off');Element.hide(this.update);Event.observe(this.element,'blur',this.onBlur.bindAsEventListener(this));Event.observe(this.element,'keydown',this.onKeyPress.bindAsEventListener(this));},show:function(){if(Element.getStyle(this.update,'display')=='none')this.options.onShow(this.element,this.update);if(!this.iefix&&(Prototype.Browser.IE)&&(Element.getStyle(this.update,'position')=='absolute')){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" '+'style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" '+'src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.update.id+'_iefix');}
if(this.iefix)setTimeout(this.fixIEOverlapping.bind(this),50);},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix);},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,'display')!='none')this.options.onHide(this.element,this.update);if(this.iefix)Element.hide(this.iefix);},startIndicator:function(){if(this.options.indicator)Element.show(this.options.indicator);},stopIndicator:function(){if(this.options.indicator)Element.hide(this.options.indicator);},onKeyPress:function(event){if(this.active)
switch(event.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(event);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(event);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(event);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(event);return;}
else
if(event.keyCode==Event.KEY_TAB||event.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&event.keyCode==0))return;this.changed=true;this.hasFocus=true;if(this.observer)clearTimeout(this.observer);this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices();},onHover:function(event){var element=Event.findElement(event,'LI');if(this.index!=element.autocompleteIndex)
{this.index=element.autocompleteIndex;this.render();}
Event.stop(event);},onClick:function(event){var element=Event.findElement(event,'LI');this.index=element.autocompleteIndex;this.selectEntry();this.hide();},onBlur:function(event){setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false;},render:function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++)
this.index==i?Element.addClassName(this.getEntry(i),"selected"):Element.removeClassName(this.getEntry(i),"selected");if(this.hasFocus){this.show();this.active=true;}}else{this.active=false;this.hide();}},markPrevious:function(){if(this.index>0)this.index--
else this.index=this.entryCount-1;this.getEntry(this.index).scrollIntoView(true);},markNext:function(){if(this.index<this.entryCount-1)this.index++
else this.index=0;this.getEntry(this.index).scrollIntoView(false);},getEntry:function(index){return this.update.firstChild.childNodes[index];},getCurrentEntry:function(){return this.getEntry(this.index);},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry());},updateElement:function(selectedElement){if(this.options.updateElement){this.options.updateElement(selectedElement);return;}
var value='';if(this.options.select){var nodes=$(selectedElement).select('.'+this.options.select)||[];if(nodes.length>0)value=Element.collectTextNodes(nodes[0],this.options.select);}else
value=Element.collectTextNodesIgnoreClass(selectedElement,'informal');var bounds=this.getTokenBounds();if(bounds[0]!=-1){var newValue=this.element.value.substr(0,bounds[0]);var whitespace=this.element.value.substr(bounds[0]).match(/^\s+/);if(whitespace)
newValue+=whitespace[0];this.element.value=newValue+value+this.element.value.substr(bounds[1]);}else{this.element.value=value;}
this.oldElementValue=this.element.value;this.element.focus();if(this.options.afterUpdateElement)
this.options.afterUpdateElement(this.element,selectedElement);},updateChoices:function(choices){if(!this.changed&&this.hasFocus){this.update.innerHTML=choices;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);entry.autocompleteIndex=i;this.addObservers(entry);}}else{this.entryCount=0;}
this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}else{this.render();}}},addObservers:function(element){Event.observe(element,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(element,"click",this.onClick.bindAsEventListener(this));},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices();}else{this.active=false;this.hide();}
this.oldElementValue=this.element.value;},getToken:function(){var bounds=this.getTokenBounds();return this.element.value.substring(bounds[0],bounds[1]).strip();},getTokenBounds:function(){if(null!=this.tokenBounds)return this.tokenBounds;var value=this.element.value;if(value.strip().empty())return[-1,0];var diff=arguments.callee.getFirstDifferencePos(value,this.oldElementValue);var offset=(diff==this.oldElementValue.length?1:0);var prevTokenPos=-1,nextTokenPos=value.length;var tp;for(var index=0,l=this.options.tokens.length;index<l;++index){tp=value.lastIndexOf(this.options.tokens[index],diff+offset-1);if(tp>prevTokenPos)prevTokenPos=tp;tp=value.indexOf(this.options.tokens[index],diff+offset);if(-1!=tp&&tp<nextTokenPos)nextTokenPos=tp;}
return(this.tokenBounds=[prevTokenPos+1,nextTokenPos]);}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(newS,oldS){var boundary=Math.min(newS.length,oldS.length);for(var index=0;index<boundary;++index)
if(newS[index]!=oldS[index])
return index;return boundary;};Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(element,update,url,options){this.baseInitialize(element,update,options);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=url;},getUpdatedChoices:function(){this.startIndicator();var entry=encodeURIComponent(this.options.paramName)+'='+
encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams)
this.options.parameters+='&'+this.options.defaultParams;new Ajax.Request(this.url,this.options);},onComplete:function(request){this.updateChoices(request.responseText);}});Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(element,update,array,options){this.baseInitialize(element,update,options);this.options.array=array;},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this));},setOptions:function(options){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(instance){var ret=[];var partial=[];var entry=instance.getToken();var count=0;for(var i=0;i<instance.options.array.length&&ret.length<instance.options.choices;i++){var elem=instance.options.array[i];var foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase()):elem.indexOf(entry);while(foundPos!=-1){if(foundPos==0&&elem.length!=entry.length){ret.push("<li><strong>"+elem.substr(0,entry.length)+"</strong>"+
elem.substr(entry.length)+"</li>");break;}else if(entry.length>=instance.options.partialChars&&instance.options.partialSearch&&foundPos!=-1){if(instance.options.fullSearch||/\s/.test(elem.substr(foundPos-1,1))){partial.push("<li>"+elem.substr(0,foundPos)+"<strong>"+
elem.substr(foundPos,entry.length)+"</strong>"+elem.substr(foundPos+entry.length)+"</li>");break;}}
foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase(),foundPos+1):elem.indexOf(entry,foundPos+1);}}
if(partial.length)
ret=ret.concat(partial.slice(0,instance.options.choices-ret.length))
return"<ul>"+ret.join('')+"</ul>";}},options||{});}});Field.scrollFreeActivate=function(field){setTimeout(function(){Field.activate(field);},1);}
Ajax.InPlaceEditor=Class.create({initialize:function(element,url,options){this.url=url;this.element=element=$(element);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(options);Object.extend(this.options,options||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+'-inplaceeditor';if($(this.options.formId))
this.options.formId='';}
if(this.options.externalControl)
this.options.externalControl=$(this.options.externalControl);if(!this.options.externalControl)
this.options.externalControlOnly=false;this._originalBackground=this.element.getStyle('background-color')||'transparent';this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners();},checkForEscapeOrReturn:function(e){if(!this._editing||e.ctrlKey||e.altKey||e.shiftKey)return;if(Event.KEY_ESC==e.keyCode)
this.handleFormCancellation(e);else if(Event.KEY_RETURN==e.keyCode)
this.handleFormSubmission(e);},createControl:function(mode,handler,extraClasses){var control=this.options[mode+'Control'];var text=this.options[mode+'Text'];if('button'==control){var btn=document.createElement('input');btn.type='submit';btn.value=text;btn.className='editor_'+mode+'_button';if('cancel'==mode)
btn.onclick=this._boundCancelHandler;this._form.appendChild(btn);this._controls[mode]=btn;}else if('link'==control){var link=document.createElement('a');link.href='#';link.appendChild(document.createTextNode(text));link.onclick='cancel'==mode?this._boundCancelHandler:this._boundSubmitHandler;link.className='editor_'+mode+'_link';if(extraClasses)
link.className+=' '+extraClasses;this._form.appendChild(link);this._controls[mode]=link;}},createEditField:function(){var text=(this.options.loadTextURL?this.options.loadingText:this.getText());var fld;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){fld=document.createElement('input');fld.type='text';var size=this.options.size||this.options.cols||0;if(0<size)fld.size=size;}else{fld=document.createElement('textarea');fld.rows=(1>=this.options.rows?this.options.autoRows:this.options.rows);fld.cols=this.options.cols||40;}
fld.name=this.options.paramName;fld.value=text;fld.className='editor_field';if(this.options.submitOnBlur)
fld.onblur=this._boundSubmitHandler;this._controls.editor=fld;if(this.options.loadTextURL)
this.loadExternalText();this._form.appendChild(this._controls.editor);},createForm:function(){var ipe=this;function addText(mode,condition){var text=ipe.options['text'+mode+'Controls'];if(!text||condition===false)return;ipe._form.appendChild(document.createTextNode(text));};this._form=$(document.createElement('form'));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();if('textarea'==this._controls.editor.tagName.toLowerCase())
this._form.appendChild(document.createElement('br'));if(this.options.onFormCustomization)
this.options.onFormCustomization(this,this._form);addText('Before',this.options.okControl||this.options.cancelControl);this.createControl('ok',this._boundSubmitHandler);addText('Between',this.options.okControl&&this.options.cancelControl);this.createControl('cancel',this._boundCancelHandler,'editor_cancel');addText('After',this.options.okControl||this.options.cancelControl);},destroy:function(){if(this._oldInnerHTML)
this.element.innerHTML=this._oldInnerHTML;this.leaveEditMode();this.unregisterListeners();},enterEditMode:function(e){if(this._saving||this._editing)return;this._editing=true;this.triggerCallback('onEnterEditMode');if(this.options.externalControl)
this.options.externalControl.hide();this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);if(!this.options.loadTextURL)
this.postProcessEditField();if(e)Event.stop(e);},enterHover:function(e){if(this.options.hoverClassName)
this.element.addClassName(this.options.hoverClassName);if(this._saving)return;this.triggerCallback('onEnterHover');},getText:function(){return this.element.innerHTML;},handleAJAXFailure:function(transport){this.triggerCallback('onFailure',transport);if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null;}},handleFormCancellation:function(e){this.wrapUp();if(e)Event.stop(e);},handleFormSubmission:function(e){var form=this._form;var value=$F(this._controls.editor);this.prepareSubmission();var params=this.options.callback(form,value)||'';if(Object.isString(params))
params=params.toQueryParams();params.editorId=this.element.id;if(this.options.htmlResponse){var options=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Updater({success:this.element},this.url,options);}else{var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,options);}
if(e)Event.stop(e);},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();if(this.options.externalControl)
this.options.externalControl.show();this._saving=false;this._editing=false;this._oldInnerHTML=null;this.triggerCallback('onLeaveEditMode');},leaveHover:function(e){if(this.options.hoverClassName)
this.element.removeClassName(this.options.hoverClassName);if(this._saving)return;this.triggerCallback('onLeaveHover');},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._form.removeClassName(this.options.loadingClassName);var text=transport.responseText;if(this.options.stripLoadedTextTags)
text=text.stripTags();this._controls.editor.value=text;this._controls.editor.disabled=false;this.postProcessEditField();}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,options);},postProcessEditField:function(){var fpc=this.options.fieldPostCreation;if(fpc)
$(this._controls.editor)['focus'==fpc?'focus':'activate']();},prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(defs){Object.extend(this.options,defs);}.bind(this));},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving();},registerListeners:function(){this._listeners={};var listener;$H(Ajax.InPlaceEditor.Listeners).each(function(pair){listener=this[pair.value].bind(this);this._listeners[pair.key]=listener;if(!this.options.externalControlOnly)
this.element.observe(pair.key,listener);if(this.options.externalControl)
this.options.externalControl.observe(pair.key,listener);}.bind(this));},removeForm:function(){if(!this._form)return;this._form.remove();this._form=null;this._controls={};},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show();},triggerCallback:function(cbName,arg){if('function'==typeof this.options[cbName]){this.options[cbName](this,arg);}},unregisterListeners:function(){$H(this._listeners).each(function(pair){if(!this.options.externalControlOnly)
this.element.stopObserving(pair.key,pair.value);if(this.options.externalControl)
this.options.externalControl.stopObserving(pair.key,pair.value);}.bind(this));},wrapUp:function(transport){this.leaveEditMode();this._boundComplete(transport,this.element);}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,element,url,options){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(element,url,options);},createEditField:function(){var list=document.createElement('select');list.name=this.options.paramName;list.size=1;this._controls.editor=list;this._collection=this.options.collection||[];if(this.options.loadCollectionURL)
this.loadCollection();else
this.checkForExternalText();this._form.appendChild(this._controls.editor);},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);this.showLoadingText(this.options.loadingCollectionText);var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){var js=transport.responseText.strip();if(!/^\[.*\]$/.test(js))
throw'Server returned an invalid collection representation.';this._collection=eval(js);this.checkForExternalText();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,options);},showLoadingText:function(text){this._controls.editor.disabled=true;var tempOption=this._controls.editor.firstChild;if(!tempOption){tempOption=document.createElement('option');tempOption.value='';this._controls.editor.appendChild(tempOption);tempOption.selected=true;}
tempOption.update((text||'').stripScripts().stripTags());},checkForExternalText:function(){this._text=this.getText();if(this.options.loadTextURL)
this.loadExternalText();else
this.buildOptionList();},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._text=transport.responseText.strip();this.buildOptionList();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,options);},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(entry){return 2===entry.length?entry:[entry,entry].flatten();});var marker=('value'in this.options)?this.options.value:this._text;var textFound=this._collection.any(function(entry){return entry[0]==marker;}.bind(this));this._controls.editor.update('');var option;this._collection.each(function(entry,index){option=document.createElement('option');option.value=entry[0];option.selected=textFound?entry[0]==marker:0==index;option.appendChild(document.createTextNode(entry[1]));this._controls.editor.appendChild(option);}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor);}});Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(options){if(!options)return;function fallback(name,expr){if(name in options||expr===undefined)return;options[name]=expr;};fallback('cancelControl',(options.cancelLink?'link':(options.cancelButton?'button':options.cancelLink==options.cancelButton==false?false:undefined)));fallback('okControl',(options.okLink?'link':(options.okButton?'button':options.okLink==options.okButton==false?false:undefined)));fallback('highlightColor',options.highlightcolor);fallback('highlightEndColor',options.highlightendcolor);};Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:'link',cancelText:'cancel',clickToEditText:'Click to edit',externalControl:null,externalControlOnly:false,fieldPostCreation:'activate',formClassName:'inplaceeditor-form',formId:null,highlightColor:'#ffff99',highlightEndColor:'#ffffff',hoverClassName:'',htmlResponse:true,loadingClassName:'inplaceeditor-loading',loadingText:'Loading...',okControl:'button',okText:'ok',paramName:'value',rows:1,savingClassName:'inplaceeditor-saving',savingText:'Saving...',size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:'',textBeforeControls:'',textBetweenControls:''},DefaultCallbacks:{callback:function(form){return Form.serialize(form);},onComplete:function(transport,element){new Effect.Highlight(element,{startcolor:this.options.highlightColor,keepBackgroundImage:true});},onEnterEditMode:null,onEnterHover:function(ipe){ipe.element.style.backgroundColor=ipe.options.highlightColor;if(ipe._effect)
ipe._effect.cancel();},onFailure:function(transport,ipe){alert('Error communication with the server: '+transport.responseText.stripTags());},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(ipe){ipe._effect=new Effect.Highlight(ipe.element,{startcolor:ipe.options.highlightColor,endcolor:ipe.options.highlightEndColor,restorecolor:ipe._originalBackground,keepBackgroundImage:true});}},Listeners:{click:'enterEditMode',keydown:'checkForEscapeOrReturn',mouseover:'enterHover',mouseout:'leaveHover'}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:'Loading options...'};Form.Element.DelayedObserver=Class.create({initialize:function(element,delay,callback){this.delay=delay||0.5;this.element=$(element);this.callback=callback;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,'keyup',this.delayedListener.bindAsEventListener(this));},delayedListener:function(event){if(this.lastValue==$F(this.element))return;if(this.timer)clearTimeout(this.timer);this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element);},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element));}});
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/bell.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/bell.js";
			
function calc_it(x,mean,dev){numerator=Math.exp(-(x-mean)*(x-mean)/(2*dev*dev));denominator=dev*Math.sqrt(2*Math.PI);return(numerator/denominator);}
function generate_bell_data(mean,dev,x1,x2,width,height){var height=62,simpleEncoding='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',cutoff1=mean-dev*1,cutoff2=mean+dev*1;if(dev<(x2-x1)/width)dev=(x2-x1)/width;var res="",highest_in_range;for(i=0;i<width;i++){x=x1+(x2-x1)*i/(width-2);value=calc_it(x,mean,dev);if(i==0||value>highest_in_range)highest_in_range=value;}
currentheight=0;x=0;data="";devi="";ratio_calc=100/width;for(i=0;i<width;i++){x=x1+(x2-x1)*i/(width-2);currentheight=Math.round((height-2)*calc_it(x,mean,dev)/highest_in_range);data+=simpleEncoding.charAt(currentheight);inrange=Math.round(i*ratio_calc);if(inrange>=cutoff1&&inrange<cutoff2)
devi+=simpleEncoding.charAt(currentheight-1);else
devi+=simpleEncoding.charAt(0);}
return[data,devi];}
function percent(ratio){return(Math.round(ratio*1000)/10)+"%";}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/board.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/board.js";
			
var BlogThisData=new Array();var PersistantBoard={};function showBlogThis(linkhtml,posttitle,quotedtext,uid,submittemplate,resulttemplate,trackback_username,trackback_boardid,trackback_url,trackback_uservar,trackback_title,opt_out,authcode){var len=BlogThisData.length;BlogThisData[len]=posttitle;BlogThisData[len+1]=quotedtext;BlogThisData[len+2]=uid;BlogThisData[len+3]=submittemplate;BlogThisData[len+4]=resulttemplate;BlogThisData[len+5]="BlogThisDiv_"+len;BlogThisData[len+6]=trackback_username;BlogThisData[len+7]=trackback_boardid;BlogThisData[len+8]=trackback_url;BlogThisData[len+9]=trackback_uservar;BlogThisData[len+10]=trackback_title;BlogThisData[len+11]=authcode;if(opt_out){document.write('<a class="inner last" href="javascript:clickBlogThis('+len+')" class="blog-this">'
+linkhtml
+'</a>');}else{document.write('<div id="BlogThisDiv_'+len+'" class="BlogThisDiv">'
+'<a href="javascript:clickBlogThis('+len+')" class="blog-this">'
+linkhtml
+'</a>'
+'</div>');}}
function invokeBlogThis(posttitle,quotedtext,editdivid,uid,submittemplate,resulttemplate,trackback_username,trackback_boardid,trackback_url,trackback_uservar,trackback_title,authcode){var len=BlogThisData.length;BlogThisData[len]=posttitle;BlogThisData[len+1]=quotedtext;BlogThisData[len+2]=uid;BlogThisData[len+3]=submittemplate;BlogThisData[len+4]=resulttemplate;BlogThisData[len+5]=editdivid;BlogThisData[len+6]=trackback_username;BlogThisData[len+7]=trackback_boardid;BlogThisData[len+8]=trackback_url;BlogThisData[len+9]=trackback_uservar;BlogThisData[len+10]=trackback_title;BlogThisData[len+11]=authcode;clickBlogThis(len);}
function clickBlogThis(num)
{var params=({"tuid":BlogThisData[num+2],"quotedtext":BlogThisData[num+1],"posttitle":BlogThisData[num],"rand":Math.round(Math.random()*1000000),"num":num});var ajax=new Ajax.Updater(BlogThisData[num+5],BlogThisData[num+3],{method:'post',parameters:params});}
function submitBlogThis(num)
{var tbackheader="";var params=({"tuid":BlogThisData[num+2],"title":BlogThisData[num],"content":tbackheader+"<blockquote>"+BlogThisData[num+1]+"</blockquote>"+$F("content_"+num),"commentsecurity":0,"commentapproval":0,"postsecurity":0,"rand":Math.round(Math.random()*1000000),"formatting":$F("formatting_"+num),"add":1,"ajax":1,"resulttemplate":BlogThisData[num+4],"authcode":BlogThisData[num+11]});if(BlogThisData[num+6]!="")
params["trackback_username"]=BlogThisData[num+6];if(BlogThisData[num+7]!="")
params["trackback_boardid"]=BlogThisData[num+7];if(BlogThisData[num+8]!="")
params["trackback_url"]=BlogThisData[num+8];if(BlogThisData[num+9]!="")
params["trackback_uservar"]=BlogThisData[num+9];if(BlogThisData[num+10]!="")
params["trackback_title"]=BlogThisData[num+10];var ajax=new Ajax.Updater(BlogThisData[num+5],"/journal",{method:'post',parameters:(params)});}
function gotData(data)
{data=eval('('+stripBreaks(data.responseText)+')');$('comment_add_'+data.boardid).style.display="none";$('comment_submit_message_'+data.boardid).style.display="none";if(data.error&&data.error=="not logged in"){url="/signup?p="+escape("/board")+"&key1=redirect&val1=1&key2=add&val2=1&key3=bid&val3="+data.bid+"&key4=url&val4="+escape(data.board_url)+"&key5=boardname&val5="+escape(data.boardname)+"&key6=text&val6="+escape(data.comment)+"&key7=uservar&val7="+escape(data.uservar);window.location.href=url;}
else{if(data.has_pending_comments==0)
{alert("pending comments gone for "+data.boardid);if($("pending_comments_"+data.boardid))
{$("pending_comments_"+data.boardid).style.display="none";}}
var navstuff;if($("comment_nav_"+data.boardid)){$A($("comment_nav_"+data.boardid).getElementsByTagName("li")).each(function(obj){Element.removeClassName(obj,"active");if(typeof obj.stashit!="undefined")obj.innerHTML=obj.stashit;if(obj.className=="st_"+starting){obj.className=obj.className+" active";span=obj.getElementsByTagName("a")[0].innerHTML;obj.stashit=obj.innerHTML;obj.innerHTML="<span>"+span+"</span>";}});navstuff=""
+$("comment_nav_"+data.boardid).getElementsByTagName("ul")[0].innerHTML
+"<li><a href='#nogo' id='close_"+data.boardid
+"' onclick=\"$('comment_load_"+data.boardid+"').innerHTML = '';\""
+">Close</a></li>";}else if(data.num_comments!=0){navstuff="<li class='st_0 active'><span>1 - "+data.num_comments+"</span></li>"
+"<li><a href='#nogo' id='close_"+data.boardid
+"' onclick=\"$('comment_load_"+data.boardid+"').innerHTML = '';\""
+">Close</a></li>";}else{navstuff="";}
var top_nav="<div class='comment_nav' id='comment_nav_top_"+data.boardid+"'><ul>"+navstuff+"</ul></div>";var bottom_nav="<div class='comment_nav' id='comment_nav_"+data.boardid+"'><ul>"+navstuff+"</ul></div>";var url="/journal?tuid="+data.ownerid+"&pid="+data.extra;var comment_added_str="";if(data.added_comment!=undefined)
{$('comment_add_link_'+data.boardid).innerHTML="<span class='holder'>Comment added.</span>";}
var hide_top_nav=0;if(data.num_comments!=undefined)
{if(data.num_comments==0){hide_top_nav=1;}}
if(!hide_top_nav)
{$("comment_load_"+data.boardid).innerHTML=top_nav+data.content+comment_added_str+bottom_nav;}
else
{$("comment_load_"+data.boardid).innerHTML=bottom_nav;}
if($("loadup_link_"+data.boardid).stashit)$("loadup_link_"+data.boardid).innerHTML=$("loadup_link_"+data.boardid).stashit;}}
function gotInterestingJournalData(data){data=eval('('+stripBreaks(data.responseText)+')');if(data.error&&data.error=="not logged in"){url="/signup?p="+escape("/board")+"&key1=redirect&val1=1&key2=add&val2=1&key3=bid&val3="+data.bid+"&key4=url&val4="+escape(data.board_url)+"&key5=boardname&val5="+escape(data.boardname)+"&key6=text&val6="+escape(data.comment)+"&key7=uservar&val7="+escape(data.uservar);window.location.href=url;}
else{$(data.boardid).innerHTML=data.content;if(window.postJournalLoad){postJournalLoad();}}}
function failed(err){}
function gotJournal(data){data=eval('('+stripBreaks(data.responseText)+')');if(!data.empty){$("jnl"+data.userid).innerHTML=data.content;}}
function failedJournal(err){}
function gotCmtCount(data){data=eval('('+stripBreaks(data.responseText)+')');var cmtstr=" Comments";if(data.count==1||data.count=="1"){cmtstr=" Comment";}
var url="/journal?tuid="+data.ownerid+"&pid="+data.extra;var count=data.count;var pending_count=data.pending_count;var page_size=20;var pageLink="";var pageLinkClose="";var num_pages=Math.floor((count+page_size-1)/page_size);if(count>0){pageLink+="<a id='loadup_link_"+data.boardid+"' href=\"javascript:loadIDBoard('"+
data.boardid+"','"+data.boardname+"','"+data.uservar+"','"+data.ownerid+"','"+data.userid+"','"+data.extra
+"', '"+0+"','"+page_size+"','"+url+"','')\">";if(pending_count>0)
{pageLinkClose+="  ("+pending_count+" pending)";}
pageLinkClose+="</a>";}else{pageLink="<span class='holder'>";pageLinkClose="</span>";}
var content="<div class='comment_count'>"+pageLink+count+cmtstr+pageLinkClose;content+="</div>";if(count>0){content+="<div class='comment_nav' id='comment_nav_"+data.boardid+"'><ul>";for(var i=0;i<num_pages;++i){start=i*20+1;end=start+19;end=(end>count?count:end);content+="<li class='st_"+(i*20)+"'><a id=\"comment_page_"+(i+1)+"_"+data.boardid+"\" href=\"javascript:loadIDBoard("
+"'"+data.boardid+"',"
+"'"+data.boardname+"',"
+"'"+data.uservar+"',"
+"'"+data.ownerid+"',"
+"'"+data.userid+"',"
+"'"+data.extra+"',"
+"'"+i*page_size+"',"
+"'"+page_size+"',"
+"'"+url+"','')"
+"\">"+start+" - "+end+"</a></li>";}
content+="</ul></div>";}
$(data.boardid).innerHTML=content;}
function failedCmtCount(data){}
function gotActionPosts(data)
{data=eval('('+stripBreaks(data.responseText)+')');$("action_posts").innerHTML=data.content;}
function failedActionPosts(data)
{}
function cacheBust(){return"&cacheBust="+Math.round(Math.random()*100000000);}
function stripBreaks(str){var res=str.replace(/\n/g," ");res=res.replace(/\n/g," ");return res;}
function confirmPostDelete(postid,authcode){if(confirm("Are you totally sure you want to delete this post?")){window.location="/jpost?authcode="+authcode+"&delete="+postid;}}
function newreq(params){return new Ajax.Request("/board",{method:'post',parameters:params,onSuccess:gotData,onFailure:failed});}
function newjreq(params){return new Ajax.Request("/journal",{method:'post',parameters:params,onSuccess:gotJournal,onFailure:failedJournal});}
function gettzo(){return"tzo="+(new Date().getTimezoneOffset()/-60);}
function addComment(formid){var myajax=newreq("add=1&start="+starting+"&limit=20&"+Form.serialize(formid)+"&"+gettzo()+cacheBust());}
function delComment(boardid){var myajax=newreq("del=1&"+Form.serialize('cmtmodify_'+boardid)+"&"+gettzo()+cacheBust());}
function delCommentInline(boardid,boardname,uservar,ownerid,userid,cid)
{var req="del=1&bid="+boardid+"&boardname="+escape(boardname)+"&uservar="
+escape(uservar)+"&ownerid="+escape(ownerid)+"&uid="+userid
+"&cid="+escape(cid)+"&"+gettzo()+cacheBust();var myajax=newreq(req);}
function approveCommentInline(boardid,boardname,uservar,ownerid,userid,cid)
{var req="approve=1&bid="+boardid+"&boardname="+escape(boardname)+"&uservar="
+escape(uservar)+"&ownerid="+escape(ownerid)+"&uid="+userid
+"&cid="+escape(cid)+"&"+gettzo()+cacheBust();var myajax=newreq(req);}
function boardActionInline(action,boardid,boardname,uservar,ownerid,userid,cid)
{if(!starting)starting=0;var req=escape(action)+"=1&bid="+boardid
+"&boardname="+escape(boardname)
+"&uservar="+escape(uservar)
+"&ownerid="+escape(ownerid)
+"&uid="+userid
+"&cid="+escape(cid)
+"&start="+starting+"&limit=20"
+"&"+gettzo()+cacheBust();var myajax=newreq(req);}
function gotUpdateResult(data)
{data=eval('('+stripBreaks(data.responseText)+')');switch(data.action)
{case"app":message="Comment approved!";break;case"del":message="Comment deleted";break;case"pend":message="Comment set to pending";break;case"delblock":message="Comment deleted, user blocked!";break;default:message="There was an error";break;}
$('actions_'+data.commentid).innerHTML="<em class='comment_result'>"+message+"</em>";}
function failedUpdateResult(err)
{alert(err);}
function commentActionInline(action,postid,commentid,postownerid,commenterid)
{if(!starting)starting=0;var req="action="+escape(action)
+"&postid="+escape(postid)
+"&commentid="+escape(commentid)
+"&postownerid="+escape(postownerid)
+"&commenterid="+escape(commenterid)
var myajax=new Ajax.Request("/journal",{method:'post',parameters:req,onSuccess:gotUpdateResult,onFailure:failedUpdateResult});}
function delAndBlock(boardid){var myajax=newreq("delblock=1&"+Form.serialize('cmtmodify_'+boardid)+"&"+gettzo()+cacheBust());}
function loadBoard(boardid,boardname,userid){var myajax=newreq("bid="+boardid+"&uid="+userid+"&boardname="+escape(boardname)+"&"+gettzo()+cacheBust());}
var starting=0;function loadIDBoard(boardid,boardname,uservar,ownerid,userid,postid,start,limit,s_url,cmtid)
{starting=start;$("loadup_link_"+boardid).stashit=$("loadup_link_"+boardid).innerHTML;$("loadup_link_"+boardid).innerHTML="Loading Comments";var req="bid="+boardid+"&boardname="+escape(boardname)+"&uservar="
+escape(uservar)+"&ownerid="+escape(ownerid)+"&uid="+userid
+"&extra="+postid+"&start="+start+"&limit="+limit+"&cmtid="
+cmtid+"&"+gettzo()+cacheBust();if(s_url!=null&&s_url.length>0){req+="&tpurl="+escape(s_url);}
var myajax=newreq(req);}
function loadRecent(recentid,userid)
{var myajax=newreq("recent="+escape(recentid)+"&uid="+userid+"&"+gettzo()+cacheBust());}
function loadRelevant(relevantid,userid,includecomments)
{var params;if(includecomments)
params="relevant="+escape(relevantid)+"&userid="+userid+"&"+gettzo()+"&comments=1&posts=1"+cacheBust();else
params="relevant="+escape(relevantid)+"&userid="+userid+"&"+gettzo()+"&posts=1"+cacheBust();var myajax=new Ajax.Request("/relevant",{method:'get',parameters:params,onSuccess:gotData,onFailure:failed});}
function loadRelevantStrangers(relevantid,userid,gender,orientation)
{var params="relevant="+escape(relevantid)
+"&userid="+userid+"&g="+gender+"&o="
+orientation+"&"+gettzo()+"&comments=1&posts=1"
+cacheBust();var myajax=new Ajax.Request("/relevant",{method:'get',parameters:params,onSuccess:gotData,onFailure:failed});}
function loadInterestingJournalPosts(relevantid,userid,limit,start,maxperuser,timestamp_weight,match_weight,distance_weight,age_diff_weight,gentation_weight,buddy_weight)
{var params="relevant="+escape(relevantid)
+"&userid="+userid
+"&limit="+limit
+"&start="+start
+"&maxperuser="+maxperuser
+"&interesting=1"
+"&timestamp_weight="+timestamp_weight
+"&match_weight="+match_weight
+"&distance_weight="+distance_weight
+"&age_diff_weight="+age_diff_weight
+"&gentation_weight="+gentation_weight
+"&buddy_weight="+buddy_weight
+"&"+gettzo()
+cacheBust();var myajax=new Ajax.Request("/relevant",{method:'get',parameters:params,onSuccess:gotInterestingJournalData,onFailure:failed});}
function loadJournal(userid){var myajax=newjreq("method=axml&tuid="+userid+"&"+gettzo()+cacheBust());}
function loadCommentCount(count_pending,boardid,boardname,uservar,ownerid,userid,postid,cmtid){PersistantBoard[boardid]={};PersistantBoard[boardid].countPending=count_pending;PersistantBoard[boardid].user_id=userid;PersistantBoard[boardid].post_id=postid;PersistantBoard[boardid].cmt_id=cmtid;var params="getcount=1&count_pending="+count_pending+"&bid="+boardid+"&boardname="+
escape(boardname)+"&uservar="+escape(uservar)+"&ownerid="+
escape(ownerid)+"&uid="+userid+"&extra="+postid+"&"+
gettzo()+cacheBust();var myajax=new Ajax.Request("/board",{method:'get',parameters:params,onSuccess:gotCmtCount,onFailure:failedCmtCount});return myajax;}
function loadActionPosts(boardid,boardname,uservar,ownerid,userid,postid){var params="get_action_posts=1&bid="+boardid+"&boardname="+
escape(boardname)+"&uservar="+escape(uservar)+"&ownerid="+
escape(ownerid)+"&uid="+userid+"&extra="+postid+"&"+
gettzo()+cacheBust();var myajax=new Ajax.Request("/board",{method:'post',parameters:params,onSuccess:gotActionPosts,onFailure:failedActionPosts});return myajax;}
function showDeleteForm2(boardid){var mydiv=$("comments_modify_js_"+boardid);var x='<input type=hidden name=url value="'+
window.location.pathname+window.location.search+'">'+'<input type=hidden name=loghash value="'+
encodeURI(getCookie("data"))+'">'+'<input type=hidden name=uid value='+
CURRENTUSERID+'>';mydiv.innerHTML=x;}
function toggleModify(boardid){divdisp=$("comments_display_"+boardid);divmod=$("comments_modify_"+boardid);if(divdisp.style.display=="none"){divdisp.style.display="block";divmod.style.display="none";}
else{divdisp.style.display="none";divmod.style.display="block";showDeleteForm2(boardid);}}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/diff_match_patch.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/diff_match_patch.js";
			
(function(){function diff_match_patch(){function a(){for(var b=0,c=1,d=2;c!=d;){b++;c=d;d<<=1}return b}this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=a()}
diff_match_patch.prototype.diff_main=function(a,b,c,d){if(typeof d=="undefined")d=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+this.Diff_Timeout*1E3;d=d;if(a==null||b==null)throw Error("Null input. (diff_main)");if(a==b){if(a)return[[0,a]];return[]}if(typeof c=="undefined")c=true;var e=c,f=this.diff_commonPrefix(a,b);c=a.substring(0,f);a=a.substring(f);b=b.substring(f);f=this.diff_commonSuffix(a,b);var h=a.substring(a.length-f);a=a.substring(0,a.length-f);b=b.substring(0,b.length-f);a=this.diff_compute(a,b,e,d);c&&a.unshift([0,c]);h&&a.push([0,h]);this.diff_cleanupMerge(a);return a};diff_match_patch.prototype.diff_compute=function(a,b,c,d){var e;if(!a)return[[1,b]];if(!b)return[[-1,a]];e=a.length>b.length?a:b;var f=a.length>b.length?b:a,h=e.indexOf(f);if(h!=-1){e=[[1,e.substring(0,h)],[0,f],[1,e.substring(h+f.length)]];if(a.length>b.length)e[0][0]=e[2][0]=-1;return e}if(f.length==1)return[[-1,a],[1,b]];if(e=this.diff_halfMatch(a,b)){var g=e[0];a=e[1];f=e[2];b=e[3];e=e[4];g=this.diff_main(g,f,c,d);d=this.diff_main(a,b,c,d);return g.concat([[0,e]],d)}if(c&&(a.length<100||b.length<100))c=false;if(c){g=this.diff_linesToChars(a,b);a=g[0];b=g[1];g=g[2]}e=this.diff_bisect(a,b,d);if(c){this.diff_charsToLines(e,g);this.diff_cleanupSemantic(e);e.push([0,""]);b=a=c=0;for(f=g="";c<e.length;){switch(e[c][0]){case 1:b++;f+=e[c][1];break;case-1:a++;g+=e[c][1];break;case 0:if(a>=1&&b>=1){g=this.diff_main(g,f,false,d);e.splice(c-a-b,a+b);c=c-a-b;for(a=g.length-1;a>=0;a--)e.splice(c,0,g[a]);c+=g.length}a=b=0;f=g=""}c++}e.pop()}return e};diff_match_patch.prototype.diff_bisect=function(a,b,c){for(var d=a.length,e=b.length,f=Math.ceil((d+e)/2),h={1:0},g={1:0},j=d-e,i=j%2!=0,k=0;k<f;k++){if((new Date).getTime()>c)break;for(var l=-k;l<=k;l+=2){var n;n=l==-k||l!=k&&h[l-1]<h[l+1]?h[l+1]:h[l-1]+1;for(var o=n-l;n<d&&o<e&&a.charAt(n)==b.charAt(o);){n++;o++}h[l]=n;if(i){var m=j-l;if(g[m]!==undefined){var p=d-g[m];if(n>=p){d=this.diff_main(a.substring(0,n),b.substring(0,o),false,c);return d.concat(this.diff_main(a.substring(n),b.substring(o),false,c))}}}}for(m=-k;m<=k;m+=2){p=m==-k||m!=k&&g[m-1]<g[m+1]?g[m+1]:g[m-1]+1;for(n=p-m;p<d&&n<e&&a.charAt(d-p-1)==b.charAt(e-n-1);){p++;n++}g[m]=p;if(!i){l=j-m;if(h[l]!==undefined){n=h[l];o=n-l;p=d-p;if(n>=p){d=this.diff_main(a.substring(0,n),b.substring(0,o),false,c);return d.concat(this.diff_main(a.substring(n),b.substring(o),false,c))}}}}}return[[-1,a],[1,b]]};diff_match_patch.prototype.diff_linesToChars=function(a,b){function c(g){for(var j="",i=0,k=-1,l=d.length;k<g.length-1;){k=g.indexOf("\n",i);if(k==-1)k=g.length-1;var n=g.substring(i,k+1);i=k+1;if(e.hasOwnProperty?e.hasOwnProperty(n):e[n]!==undefined)j+=String.fromCharCode(e[n]);else{j+=String.fromCharCode(l);e[n]=l;d[l++]=n}}return j}var d=[],e={};d[0]="";var f=c(a),h=c(b);return[f,h,d]};diff_match_patch.prototype.diff_charsToLines=function(a,b){for(var c=0;c<a.length;c++){for(var d=a[c][1],e=[],f=0;f<d.length;f++)e[f]=b[d.charCodeAt(f)];a[c][1]=e.join("")}};diff_match_patch.prototype.diff_commonPrefix=function(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;c<e;){if(a.substring(f,e)==b.substring(f,e))f=c=e;else d=e;e=Math.floor((d-c)/2+c)}return e};diff_match_patch.prototype.diff_commonSuffix=function(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;c<e;){if(a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f))f=c=e;else d=e;e=Math.floor((d-c)/2+c)}return e};diff_match_patch.prototype.diff_commonOverlap=function(a,b){var c=a.length,d=b.length;if(c==0||d==0)return 0;if(c>d)a=a.substring(c-d);else if(c<d)b=b.substring(0,c);c=Math.min(c,d);if(a==b)return c;d=0;for(var e=1;;){var f=a.substring(c-e);f=b.indexOf(f);if(f==-1)return d;e+=f;if(f==0||a.substring(c-e)==b.substring(0,e)){d=e;e++}}};diff_match_patch.prototype.diff_halfMatch=function(a,b){function c(i,k,l){for(var n=i.substring(l,l+Math.floor(i.length/4)),o=-1,m="",p,q,s,r;(o=k.indexOf(n,o+1))!=-1;){var t=f.diff_commonPrefix(i.substring(l),k.substring(o)),u=f.diff_commonSuffix(i.substring(0,l),k.substring(0,o));if(m.length<u+t){m=k.substring(o-u,o)+k.substring(o,o+t);p=i.substring(0,l-u);q=i.substring(l+t);s=k.substring(0,o-u);r=k.substring(o+t)}}return m.length*2>=i.length?[p,q,s,r,m]:null}var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(d.length<4||e.length*2<d.length)return null;var f=this,h=c(d,e,Math.ceil(d.length/4));d=c(d,e,Math.ceil(d.length/2));var g;if(!h&&!d)return null;else g=d?h?h[4].length>d[4].length?h:d:d:h;var j;if(a.length>b.length){h=g[0];d=g[1];e=g[2];j=g[3]}else{e=g[0];j=g[1];h=g[2];d=g[3]}g=g[4];return[h,d,e,j,g]};diff_match_patch.prototype.diff_cleanupSemantic=function(a){for(var b=false,c=[],d=0,e=null,f=0,h=0,g=0,j=0,i=0;f<a.length;){if(a[f][0]==0){c[d++]=f;h=j;g=i;i=j=0;e=a[f][1]}else{if(a[f][0]==1)j+=a[f][1].length;else i+=a[f][1].length;if(e!==null&&e.length<=Math.max(h,g)&&e.length<=Math.max(j,i)){a.splice(c[d-1],0,[-1,e]);try{a[c[d-1]+1][0]=1;}catch(e){}d--;d--;f=d>0?c[d-1]:-1;i=j=g=h=0;e=null;b=true}}f++}b&&this.diff_cleanupMerge(a);this.diff_cleanupSemanticLossless(a);for(f=1;f<a.length;){if(a[f-1][0]==-1&&a[f][0]==1){b=a[f-1][1];c=a[f][1];if(d=this.diff_commonOverlap(b,c)){a.splice(f,0,[0,c.substring(0,d)]);a[f-1][1]=b.substring(0,b.length-d);a[f+1][1]=c.substring(d);f++}f++}f++}};diff_match_patch.prototype.diff_cleanupSemanticLossless=function(a){function b(q,s){if(!q||!s)return 5;var r=0;if(q.charAt(q.length-1).match(c)||s.charAt(0).match(c)){r++;if(q.charAt(q.length-1).match(d)||s.charAt(0).match(d)){r++;if(q.charAt(q.length-1).match(e)||s.charAt(0).match(e)){r++;if(q.match(f)||s.match(h))r++}}}return r}for(var c=/[^a-zA-Z0-9]/,d=/\s/,e=/[\r\n]/,f=/\n\r?\n$/,h=/^\r?\n\r?\n/,g=1;g<a.length-1;){if(a[g-1][0]==0&&a[g+1][0]==0){var j=a[g-1][1],i=a[g][1],k=a[g+1][1],l=this.diff_commonSuffix(j,i);if(l){var n=i.substring(i.length-l);j=j.substring(0,j.length-l);i=n+i.substring(0,i.length-l);k=n+k}l=j;n=i;for(var o=k,m=b(j,i)+b(i,k);i.charAt(0)===k.charAt(0);){j+=i.charAt(0);i=i.substring(1)+k.charAt(0);k=k.substring(1);var p=b(j,i)+b(i,k);if(p>=m){m=p;l=j;n=i;o=k}}if(a[g-1][1]!=l){if(l)a[g-1][1]=l;else{a.splice(g-1,1);g--}a[g][1]=n;if(o)a[g+1][1]=o;else{a.splice(g+1,1);g--}}}g++}};diff_match_patch.prototype.diff_cleanupEfficiency=function(a){for(var b=false,c=[],d=0,e="",f=0,h=false,g=false,j=false,i=false;f<a.length;){if(a[f][0]==0){if(a[f][1].length<this.Diff_EditCost&&(j||i)){c[d++]=f;h=j;g=i;e=a[f][1]}else{d=0;e=""}j=i=false}else{if(a[f][0]==-1)i=true;else j=true;if(e&&(h&&g&&j&&i||e.length<this.Diff_EditCost/2&&h+g+j+i==3)){a.splice(c[d-1],0,[-1,e]);a[c[d-1]+1][0]=1;d--;e="";if(h&&g){j=i=true;d=0}else{d--;f=d>0?c[d-1]:-1;j=i=false}b=true}}f++}b&&this.diff_cleanupMerge(a)};diff_match_patch.prototype.diff_cleanupMerge=function(a){a.push([0,""]);for(var b=0,c=0,d=0,e="",f="",h;b<a.length;)switch(a[b][0]){case 1:d++;f+=a[b][1];b++;break;case-1:c++;e+=a[b][1];b++;break;case 0:if(c+d>1){if(c!==0&&d!==0){h=this.diff_commonPrefix(f,e);if(h!==0){if(b-c-d>0&&a[b-c-d-1][0]==0)a[b-c-d-1][1]+=f.substring(0,h);else{a.splice(0,0,[0,f.substring(0,h)]);b++}f=f.substring(h);e=e.substring(h)}h=this.diff_commonSuffix(f,e);if(h!==0){a[b][1]=f.substring(f.length-h)+a[b][1];f=f.substring(0,f.length-h);e=e.substring(0,e.length-h)}}if(c===0)a.splice(b-c-d,c+d,[1,f]);else d===0?a.splice(b-c-d,c+d,[-1,e]):a.splice(b-c-d,c+d,[-1,e],[1,f]);b=b-c-d+(c?1:0)+(d?1:0)+1}else if(b!==0&&a[b-1][0]==0){a[b-1][1]+=a[b][1];a.splice(b,1)}else b++;c=d=0;f=e=""}a[a.length-1][1]===""&&a.pop();c=false;for(b=1;b<a.length-1;){if(a[b-1][0]==0&&a[b+1][0]==0)if(a[b][1].substring(a[b][1].length-a[b-1][1].length)==a[b-1][1]){a[b][1]=a[b-1][1]+a[b][1].substring(0,a[b][1].length-a[b-1][1].length);a[b+1][1]=a[b-1][1]+
a[b+1][1];a.splice(b-1,1);c=true}else if(a[b][1].substring(0,a[b+1][1].length)==a[b+1][1]){a[b-1][1]+=a[b+1][1];a[b][1]=a[b][1].substring(a[b+1][1].length)+a[b+1][1];a.splice(b+1,1);c=true}b++}c&&this.diff_cleanupMerge(a)};diff_match_patch.prototype.diff_xIndex=function(a,b){var c=0,d=0,e=0,f=0,h;for(h=0;h<a.length;h++){if(a[h][0]!==1)c+=a[h][1].length;if(a[h][0]!==-1)d+=a[h][1].length;if(c>b)break;e=c;f=d}if(a.length!=h&&a[h][0]===-1)return f;return f+(b-e)};diff_match_patch.prototype.diff_prettyHtml=function(a){for(var b=[],c=0,d=/&/g,e=/</g,f=/>/g,h=/\n/g,g=0;g<a.length;g++){var j=a[g][0],i=a[g][1],k=i.replace(d,"&amp;").replace(e,"&lt;").replace(f,"&gt;").replace(h,"&para;<br>");switch(j){case 1:b[g]='<ins style="background:#E6FFE6;">'+k+"</ins>";break;case-1:b[g]='<del style="background:#FFE6E6;">'+k+"</del>";break;case 0:b[g]="<span>"+k+"</span>"}if(j!==-1)c+=i.length}return b.join("")};diff_match_patch.prototype.diff_text1=function(a){for(var b=[],c=0;c<a.length;c++)if(a[c][0]!==1)b[c]=a[c][1];return b.join("")};diff_match_patch.prototype.diff_text2=function(a){for(var b=[],c=0;c<a.length;c++)if(a[c][0]!==-1)b[c]=a[c][1];return b.join("")};diff_match_patch.prototype.diff_levenshtein=function(a){for(var b=0,c=0,d=0,e=0;e<a.length;e++){var f=a[e][0],h=a[e][1];switch(f){case 1:c+=h.length;break;case-1:d+=h.length;break;case 0:b+=Math.max(c,d);d=c=0}}b+=Math.max(c,d);return b};diff_match_patch.prototype.diff_toDelta=function(a){for(var b=[],c=0;c<a.length;c++)switch(a[c][0]){case 1:b[c]="+"+encodeURI(a[c][1]);break;case-1:b[c]="-"+a[c][1].length;break;case 0:b[c]="="+a[c][1].length}return b.join("\t").replace(/%20/g," ")};diff_match_patch.prototype.diff_fromDelta=function(a,b){for(var c=[],d=0,e=0,f=b.split(/\t/g),h=0;h<f.length;h++){var g=f[h].substring(1);switch(f[h].charAt(0)){case"+":try{c[d++]=[1,decodeURI(g)]}catch(j){throw Error("Illegal escape in diff_fromDelta: "+g);}break;case"-":case"=":var i=parseInt(g,10);if(isNaN(i)||i<0)throw Error("Invalid number in diff_fromDelta: "+g);g=a.substring(e,e+=i);if(f[h].charAt(0)=="=")c[d++]=[0,g];else c[d++]=[-1,g];break;default:if(f[h])throw Error("Invalid diff operation in diff_fromDelta: "+
f[h]);}}if(e!=a.length)throw Error("Delta length ("+e+") does not equal source text length ("+a.length+").");return c};diff_match_patch.prototype.match_main=function(a,b,c){if(a==null||b==null||c==null)throw Error("Null input. (match_main)");c=Math.max(0,Math.min(c,a.length));return a==b?0:a.length?a.substring(c,c+b.length)==b?c:this.match_bitap(a,b,c):-1};diff_match_patch.prototype.match_bitap=function(a,b,c){function d(q,s){var r=q/b.length,t=Math.abs(c-s);if(!f.Match_Distance)return t?1:r;return r+t/f.Match_Distance}if(b.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var e=this.match_alphabet(b),f=this,h=this.Match_Threshold,g=a.indexOf(b,c);if(g!=-1){h=Math.min(d(0,g),h);g=a.lastIndexOf(b,c+b.length);if(g!=-1)h=Math.min(d(0,g),h)}var j=1<<b.length-1;g=-1;for(var i,k,l=b.length+a.length,n,o=0;o<b.length;o++){i=0;for(k=l;i<k;){if(d(o,c+k)<=h)i=k;else l=k;k=Math.floor((l-i)/2+i)}l=k;i=Math.max(1,c-k+1);var m=Math.min(c+k,a.length)+b.length;k=Array(m+2);k[m+1]=(1<<o)-1;for(m=m;m>=i;m--){var p=e[a.charAt(m-1)];k[m]=o===0?(k[m+1]<<1|1)&p:(k[m+1]<<1|1)&p|(n[m+1]|n[m])<<1|1|n[m+1];if(k[m]&j){p=d(o,m-1);if(p<=h){h=p;g=m-1;if(g>c)i=Math.max(1,2*c-g);else break}}}if(d(o+1,c)>h)break;n=k}return g};diff_match_patch.prototype.match_alphabet=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=0;for(c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b};diff_match_patch.prototype.patch_addContext=function(a,b){if(b.length!=0){for(var c=b.substring(a.start2,a.start2+a.length1),d=0;b.indexOf(c)!=b.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;){d+=this.Patch_Margin;c=b.substring(a.start2-d,a.start2+a.length1+d)}d+=this.Patch_Margin;(c=b.substring(a.start2-d,a.start2))&&a.diffs.unshift([0,c]);(d=b.substring(a.start2+a.length1,a.start2+a.length1+d))&&a.diffs.push([0,d]);a.start1-=c.length;a.start2-=c.length;a.length1+=c.length+d.length;a.length2+=c.length+d.length}};diff_match_patch.prototype.patch_make=function(a,b,c){var d;if(typeof a=="string"&&typeof b=="string"&&typeof c=="undefined"){d=a;b=this.diff_main(d,b,true);if(b.length>2){this.diff_cleanupSemantic(b);this.diff_cleanupEfficiency(b)}}else if(a&&typeof a=="object"&&typeof b=="undefined"&&typeof c=="undefined"){b=a;d=this.diff_text1(b)}else if(typeof a=="string"&&b&&typeof b=="object"&&typeof c=="undefined"){d=a;b=b}else if(typeof a=="string"&&typeof b=="string"&&c&&typeof c=="object"){d=a;b=c}else throw Error("Unknown call format to patch_make.");if(b.length===0)return[];c=[];a=new patch_obj;var e=0,f=0,h=0,g=d;d=d;for(var j=0;j<b.length;j++){var i=b[j][0],k=b[j][1];if(!e&&i!==0){a.start1=f;a.start2=h}switch(i){case 1:a.diffs[e++]=b[j];a.length2+=k.length;d=d.substring(0,h)+k+d.substring(h);break;case-1:a.length1+=k.length;a.diffs[e++]=b[j];d=d.substring(0,h)+d.substring(h+k.length);break;case 0:if(k.length<=2*this.Patch_Margin&&e&&b.length!=j+1){a.diffs[e++]=b[j];a.length1+=k.length;a.length2+=k.length}else if(k.length>=2*this.Patch_Margin)if(e){this.patch_addContext(a,g);c.push(a);a=new patch_obj;e=0;g=d;f=h}}if(i!==1)f+=k.length;if(i!==-1)h+=k.length}if(e){this.patch_addContext(a,g);c.push(a)}return c};diff_match_patch.prototype.patch_deepCopy=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=new patch_obj;e.diffs=[];for(var f=0;f<d.diffs.length;f++)e.diffs[f]=d.diffs[f].slice();e.start1=d.start1;e.start2=d.start2;e.length1=d.length1;e.length2=d.length2;b[c]=e}return b};diff_match_patch.prototype.patch_apply=function(a,b){if(a.length==0)return[b,[]];a=this.patch_deepCopy(a);var c=this.patch_addPadding(a);b=c+b+c;this.patch_splitMax(a);for(var d=0,e=[],f=0;f<a.length;f++){var h=a[f].start2+d,g=this.diff_text1(a[f].diffs),j,i=-1;if(g.length>this.Match_MaxBits){j=this.match_main(b,g.substring(0,this.Match_MaxBits),h);if(j!=-1){i=this.match_main(b,g.substring(g.length-this.Match_MaxBits),h+g.length-this.Match_MaxBits);if(i==-1||j>=i)j=-1}}else j=this.match_main(b,g,h);if(j==-1){e[f]=false;d-=a[f].length2-a[f].length1}else{e[f]=true;d=j-h;h=i==-1?b.substring(j,j+g.length):b.substring(j,i+this.Match_MaxBits);if(g==h)b=b.substring(0,j)+this.diff_text2(a[f].diffs)+b.substring(j+g.length);else{h=this.diff_main(g,h,false);if(g.length>this.Match_MaxBits&&this.diff_levenshtein(h)/g.length>this.Patch_DeleteThreshold)e[f]=false;else{this.diff_cleanupSemanticLossless(h);g=0;var k;for(i=0;i<a[f].diffs.length;i++){var l=a[f].diffs[i];if(l[0]!==0)k=this.diff_xIndex(h,g);if(l[0]===1)b=b.substring(0,j+k)+l[1]+b.substring(j+k);else if(l[0]===-1)b=b.substring(0,j+k)+b.substring(j+this.diff_xIndex(h,g+l[1].length));if(l[0]!==-1)g+=l[1].length}}}}}b=b.substring(c.length,b.length-c.length);return[b,e]};diff_match_patch.prototype.patch_addPadding=function(a){for(var b=this.Patch_Margin,c="",d=1;d<=b;d++)c+=String.fromCharCode(d);for(d=0;d<a.length;d++){a[d].start1+=b;a[d].start2+=b}d=a[0];var e=d.diffs;if(e.length==0||e[0][0]!=0){e.unshift([0,c]);d.start1-=b;d.start2-=b;d.length1+=b;d.length2+=b}else if(b>e[0][1].length){var f=b-e[0][1].length;e[0][1]=c.substring(e[0][1].length)+e[0][1];d.start1-=f;d.start2-=f;d.length1+=f;d.length2+=f}d=a[a.length-1];e=d.diffs;if(e.length==0||e[e.length-1][0]!=0){e.push([0,c]);d.length1+=b;d.length2+=b}else if(b>e[e.length-1][1].length){f=b-e[e.length-1][1].length;e[e.length-1][1]+=c.substring(0,f);d.length1+=f;d.length2+=f}return c};diff_match_patch.prototype.patch_splitMax=function(a){for(var b=this.Match_MaxBits,c=0;c<a.length;c++)if(a[c].length1>b){var d=a[c];a.splice(c--,1);for(var e=d.start1,f=d.start2,h="";d.diffs.length!==0;){var g=new patch_obj,j=true;g.start1=e-h.length;g.start2=f-h.length;if(h!==""){g.length1=g.length2=h.length;g.diffs.push([0,h])}for(;d.diffs.length!==0&&g.length1<b-this.Patch_Margin;){h=d.diffs[0][0];var i=d.diffs[0][1];if(h===1){g.length2+=i.length;f+=i.length;g.diffs.push(d.diffs.shift());j=false}else if(h===-1&&g.diffs.length==1&&g.diffs[0][0]==0&&i.length>2*b){g.length1+=i.length;e+=i.length;j=false;g.diffs.push([h,i]);d.diffs.shift()}else{i=i.substring(0,b-g.length1-this.Patch_Margin);g.length1+=i.length;e+=i.length;if(h===0){g.length2+=i.length;f+=i.length}else j=false;g.diffs.push([h,i]);if(i==d.diffs[0][1])d.diffs.shift();else d.diffs[0][1]=d.diffs[0][1].substring(i.length)}}h=this.diff_text2(g.diffs);h=h.substring(h.length-this.Patch_Margin);i=this.diff_text1(d.diffs).substring(0,this.Patch_Margin);if(i!==""){g.length1+=i.length;g.length2+=i.length;if(g.diffs.length!==0&&g.diffs[g.diffs.length-1][0]===0)g.diffs[g.diffs.length-1][1]+=i;else g.diffs.push([0,i])}j||a.splice(++c,0,g)}}};diff_match_patch.prototype.patch_toText=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];return b.join("")};diff_match_patch.prototype.patch_fromText=function(a){var b=[];if(!a)return b;a=a.split("\n");for(var c=0,d=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;c<a.length;){var e=a[c].match(d);if(!e)throw Error("Invalid patch string: "+a[c]);var f=new patch_obj;b.push(f);f.start1=parseInt(e[1],10);if(e[2]===""){f.start1--;f.length1=1}else if(e[2]=="0")f.length1=0;else{f.start1--;f.length1=parseInt(e[2],10)}f.start2=parseInt(e[3],10);if(e[4]===""){f.start2--;f.length2=1}else if(e[4]=="0")f.length2=0;else{f.start2--;f.length2=parseInt(e[4],10)}for(c++;c<a.length;){e=a[c].charAt(0);try{var h=decodeURI(a[c].substring(1))}catch(g){throw Error("Illegal escape in patch_fromText: "+h);}if(e=="-")f.diffs.push([-1,h]);else if(e=="+")f.diffs.push([1,h]);else if(e==" ")f.diffs.push([0,h]);else if(e=="@")break;else if(e!=="")throw Error('Invalid patch mode "'+e+'" in: '+h);c++}}return b};function patch_obj(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0}
patch_obj.prototype.toString=function(){var a,b;a=this.length1===0?this.start1+",0":this.length1==1?this.start1+1:this.start1+1+","+this.length1;b=this.length2===0?this.start2+",0":this.length2==1?this.start2+1:this.start2+1+","+this.length2;a=["@@ -"+a+" +"+b+" @@\n"];var c;for(b=0;b<this.diffs.length;b++){switch(this.diffs[b][0]){case 1:c="+";break;case-1:c="-";break;case 0:c=" "}a[b+1]=c+encodeURI(this.diffs[b][1])+"\n"}return a.join("").replace(/%20/g," ")};window.diff_match_patch=diff_match_patch;window.patch_obj=patch_obj;window.DIFF_DELETE=-1;window.DIFF_INSERT=1;window.DIFF_EQUAL=0;})()
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/Oryx/Votes.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/Oryx/Votes.js";
			
function processVoteNote(vote_or_note,vote_type,rating,tuid,similar_users,target_objectid,stopUnloadBlink,success_function){var the_pad=$('note-pad');if(the_pad&&the_pad.style.display!="none"||vote_or_note=="vote"){var the_url="/vote_handler";var note_text=$('note-text');if(note_text){note_text=note_text.childNodes[0].value;}
var params={voterid:CURRENTUSERID,target_userid:tuid,type:vote_or_note};if(vote_or_note=="vote"){params["target_objectid"]=(target_objectid)?target_objectid:"0";params["vote_type"]=vote_type;params["score"]=rating;if(rating==0){params["cant_tell"]="1";}}
else{params["note"]=note_text;}
if(typeof Quickmatch!='undefined'){new Ajax.Request(the_url,{parameters:params,onSuccess:function(){document.quickmatchform.previous_personality.value=rating;document.quickmatchform.submit();},onFailure:function(){}});}
else{new Ajax.Request(the_url,{parameters:params,onSuccess:function(data){if(vote_or_note=="vote"){var rater;for(var i=0;i<5;i++){rater=$('current-'+vote_type+'-'+tuid+'-'+i);if(!rater)break;rater.style.width=rating*20+"%";}
if(rating==0){$(vote_type+'-rating').addClassName('faded');}
$(vote_type+'-click-away-'+tuid).focus();}
success_function;},onFailure:function(data){var v_n=(vote_or_note=="vote")?"vote":"notes";alert("Your "+v_n+" couldn't be processed. Please try again later.");}});}
if(similar_users&&rating>3){new Ajax.Updater('rating_recommended','/vote_similar',{parameters:{tuid:tuid},method:'get'});$('personality-click-away-'+tuid).focus();setTimeout("$('rating_recommended').show();",1000);}
util.registerSuggestionActivity('rate_a_profile');}
if(vote_or_note=="note"){if(!stopUnloadBlink)the_pad.toggle();}
if(typeof LOTCC!='undefined')
LOTCC.bcpw("act","Vote");if(typeof Profile!='undefined'){DC.recordVote(Profile.tracking_data);}
Votes.acknowledgedPublicVote();}
function processedVoteNoteQMSuccess(vote_type,vote_or_note,tuid,rating)
{if(vote_or_note=="vote")
{var is_safari=navigator.userAgent.search(/Safari/);if(rating==0){$(vote_type+'-rating').addClassName('faded');}
$('current-'+vote_type+'-'+tuid).setStyle({width:(rating*20+"%"),height:'17px'});if(is_safari=="-1"){$(vote_type+'-click-away-'+tuid).focus();}}
if(vote_type=="personality")
{document.quickmatchform.previous_personality.value=rating;document.quickmatchform.submit();}}
function processedVoteNoteQMFailure(data)
{alert("Your vote couldn't be processed. Please try again later.");}
function activateNoteAutosave(v_or_n,l_or_p,r,uid){Event.observe(window,'unload',function(){processVoteNote(v_or_n,l_or_p,r,uid,false,false,true);});}
function preloadNotePad(){util.preloadImages(['http://akcdn.okccdn.com/_img/layout2/buttons/note_pad_bg.gif','http://akcdn.okccdn.com/_img/layout2/buttons/update_notes.gif']);}
function closeRecommendations(){$('rating_recommended').style.display="none";}
var Votes={hovering:false,acknowledged_public_vote:false,warning_timeout:null,publicStarOver:function(star_ul){this.hovering=true;if(this.acknowledged_public_vote)
return;var public_warning_div=$('public_warning');if(public_warning_div){$(star_ul).insert({after:public_warning_div.remove()});this.warning_timeout=(function(el,hovering){if(this.hovering)
el.show();}).bind(this,public_warning_div).delay(0.25);}
else{this.acknowledged_public_vote=true;}},publicStarOut:function(star_ul){this.hovering=false;clearTimeout(this.warning_timeout);if(this.acknowledged_public_vote)
return;(function(){if(!this.hovering)
this.hidePublicWarning();}).bind(this).delay(0.01);},acknowledgedPublicVote:function(){if(this.acknowledged_public_vote)
return;this.acknowledged_public_vote=true;this.hidePublicWarning();AjaxSookie.set('acknowledged_public_vote',1,(86400*365*10),'404f70bf354e33507fb3915cd3ef43ca12742e1a');},hidePublicWarning:function(){var public_warning_div=$('public_warning');if(public_warning_div)
public_warning_div.hide();}};
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/twitter.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/twitter.js";
			
function toggleTweet(prefix,text_container,url){if($('tweet_box').hasClassName('hidden')){if(prefix&&text_container&&url){$('tweetprefix').update(prefix);$('tweetext').update($(text_container).innerHTML.strip().stripTags().substr(0,140));$('twitter_text').value=$(text_container).innerHTML.strip().stripTags();$('twitter_url').value=url;}
$('tweet_box').setStyle({top:(250+document.viewport.getScrollOffsets().top)+'px'}).removeClassName('hidden');}
else{$('tweet_box').addClassName('hidden');$('tweet_success','tweet_failure').invoke('hide');$('tweet_form').show();}}
function doTweet(tweet,params){if($('twitter_submit').hasClassName('gray'))
return false;new Ajax.Request('/twitter',{method:'post',parameters:{pass:$F('twitter_password'),user:$F('twitter_username'),dont_ask:$('twitter_dont_ask').checked?1:0,tweet:$F('twitter_text'),quoted:$F('twitter_quoted'),stat_cat:$F('twitter_stat_cat'),url:$F('twitter_url')},onSuccess:function(transport){var response=transport.responseText.evalJSON();$('tweet_form').hide();if(response.status){$('tweet_success').show();}
else{$('tweet_failure_reason').update('<strong>Reason:</strong> '+response.error);$('tweet_failure').show();}}});}
function cancelTweet(){toggleTweet();retryTweet();}
function retryTweet(){$('tweet_success').hide();$('tweet_failure').hide();$('tweet_form').show();}
function checkTwitterInputs(){if(!$F('twitter_username').blank()&&!$F('twitter_password').blank()){$('twitter_submit').removeClassName('gray').addClassName('green');}
else{$('twitter_submit').removeClassName('green').addClassName('gray');}}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/service/bigdig.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/service/bigdig.js";
			
BigDigController=Class.create({m_self_view:0,m_show_all:0,questions_loaded:0,questions_answered:null,questions_public:null,consecutive_irrelevants:0,submitting:{},warnings:{consecutive_irrelevants:'Try marking more questions as important! <br/><br/>Our matching system works because we find people who care about the same things you do. Marking lots of questions as &lsquo;irrelevant&rsquo; doesn&rsquo;t help us find your potential matches.<br/><br/>The more questions you mark as important, the more you&rsquo;ll like your matches&mdash;and the less you&rsquo;ll sit through dates with people you can&rsquo;t stand!<br/><br/>Give it a whirl when you <a href="#" onclick="BigDig.hidePageWarning();return false;">answer the next question</a>.',no_more_questions:'Wow, you answered ALL THE THINGS! Why not <a href="/match">go find a match</a>?'},initialize:function(self_view,show_all,self,consec){this.m_self_view=self_view;this.m_show_all=show_all;if(self){this.questions_answered=self.num_answered;this.questions_loaded=self.num_answered;this.questions_public=self.num_public;}
if(typeof consec=='undefined'){var consec=0;}
this.consecutive_irrelevants=consec;if($('new_question')&&$('new_question').hasClassName('new')&&$('new_question').down('.question')){var qid=$('new_question').down('.question').id.replace('question_','');this.toggleSponsorship(qid);}},toggleAnswer:function(qid,reanswering){var qdiv=$('question_'+qid);if(this.m_self_view||reanswering||qdiv.hasClassName('reanswering')){qdiv.toggleClassName('reanswering');}
else{qdiv.toggleClassName('answering');}
this.toggleSponsorship(qid);$('error_'+qid).hide();},makePublic:function(qid){$('skip_btn_'+qid).hide();var my_answer=$F('question_'+qid+'_answer');var matchanswers=parseInt($F('question_'+qid+'_match_answers')).bitmaskToSet(5);var importance=$F('question_'+qid+'_importance');new Ajax.Request('/questions/ask',{parameters:{ajax:1,go_public:1,qid:qid,answers:my_answer,matchanswers:matchanswers,importance:importance,targetid:$F('target_userid'),submit:1,show_all:this.m_show_all},onSuccess:BigDig.makePublic_cb.bindAsEventListener(this,qid)});},makePublic_cb:function(transport,qid){var response=transport.responseText.evalJSON();if(!response.status){this.publicizeQuestion(response,qid);}},skip:function(qid){$('skip_'+qid).value=1;this.submitAnswer(qid,true);},submitAnswer:function(qid){if(this.submitting[qid])
return;this.submitting[qid]=true;var new_question=$('is_new_question_'+qid)?true:false;var my_answer=$('answer_'+qid).getValues('my_answer');var match_answers=$('answer_'+qid).getValues('their_answer');var importance=$('answer_'+qid).getValues('importance');var is_public=$('public_'+qid).value=='on'?1:0;var skip=$F('skip_'+qid);var note=(is_public==1&&skip==0)?$F('answer_'+qid+'_note'):'';if(this.m_self_view)
var prev_note=$('explanation_'+qid).innerHTML;else
var prev_note=$('note_viewer_'+qid).innerHTML;var reanswering=$F('reanswering_'+qid);if(!$('submit_btn_'+qid)||$('submit_btn_'+qid).hasClassName('gray')&&!skip)
return;$('skip_'+qid).value=0;if(!my_answer&&!skip){$('error_'+qid).update('You must select an answer.').showOrPulse();}
else if(!match_answers&&!importance&&!skip){$('error_'+qid).update('You must select how your ideal match would answer this question.').showOrPulse();}
else if(!importance&&!skip){$('error_'+qid).update('You must select how important this question is to you.').showOrPulse();}
else{this.submitSponsorshipAnswers(qid);new Ajax.Request('/questions/ask',{parameters:{ajax:1,qid:qid,answers:my_answer,matchanswers:match_answers,importance:importance,note:(note.blank()&&!prev_note.blank())?'delete':note,delete_note:(note.blank()&&!prev_note.blank())?1:0,targetid:is_public?$F('target_userid'):0,submit:1,answer_question:skip=='1'?0:1,is_public:is_public?"on":0,skip:skip,reanswering:reanswering,show_all:this.m_show_all,questions_answered:this.questions_answered},onComplete:this.submitAnswer_complete.bindAsEventListener(this,qid),onSuccess:this.submitAnswer_cb.bindAsEventListener(this,qid,new_question),onFailure:this.submitAnswer_failure.bindAsEventListener(this,qid,new_question)});}},submitAnswer_complete:function(transport,qid){this.submitting[qid]=false;},submitAnswer_cb:function(transport,qid,new_question){var response=transport.responseText.evalJSON();if(!response.status){if(new_question){var new_q_wrapper=$('new_question');var new_q=new_q_wrapper.down('.question_wrap');if(!new_q)
new_q=new_q_wrapper.down('.question');new_q_wrapper.setStyle({height:new_q_wrapper.getHeight()+'px'});new_q.remove().setStyle({position:'absolute',top:new_q_wrapper.offsetTop+'px',zIndex:10000});new_q_wrapper.insert({after:new_q});new_q.dropOut({duration:0.5});setTimeout(function(response,qid,new_q_wrapper,new_q){new_q.hide();if(new_q.hasClassName('question_wrap')){if(new_q.down('.notice'))new_q.down('.notice').remove();if(new_q.down('.sr_message'))new_q.down('.sr_message').remove();new_q.setStyle({marginBottom:'3px'});}
new_q.setStyle({position:'',top:''});this.updateQuestionRow(response,qid);var previous_q=new_q.next();if(previous_q){previous_q.morph({marginTop:(new_q.getHeight()+18)+'px'},{duration:0.25});}
var newer_q=new_q_wrapper.down('.question_wrap');if(!newer_q)
newer_q=new_q_wrapper.down('.question');if(!newer_q)
newer_q=new_q_wrapper.down('.sr_message');newer_q.setStyle({position:''});new_q_wrapper.morph({height:newer_q.getHeight()+'px'},{duration:0.25});setTimeout(function(new_q_wrapper,new_q,previous_q){new_q.setStyle({display:'',visibility:'hidden'}).absolutize().setStyle({display:'none',visibility:''}).appear({duration:0.25});new_q_wrapper.setStyle({height:'auto'});this.adjustQuestions();setTimeout(function(new_q,previous_q){if(previous_q)
previous_q.setStyle({marginTop:0});new_q.setStyle({position:'',top:'',left:'',right:'',bottom:'',zIndex:'',height:'auto'}).removeClassName('new');this.refreshAds();if($('new_question')&&$('new_question').down('.question')){var new_id=$('new_question').down('.question').id;if(new_id&&new_id!=''){new_id=new_id.replace('question_','');this.toggleSponsorship(new_id);}}}.bind(this,new_q,previous_q),500);}.bind(this,new_q_wrapper,new_q,previous_q),500);}.bind(this,response,qid,new_q_wrapper,new_q),600);if(response.next_question){var show_next=response.next_question;}
else{$('questions_warning_comment').update(this.warnings.no_more_questions);var show_next=$('questions_warning').remove().show();}
new_q_wrapper.update(show_next);var newer_q=new_q_wrapper.down('.question_wrap');if(!newer_q)
newer_q=new_q_wrapper.down('.question');if(!newer_q)
newer_q=new_q_wrapper.down('.sr_message');newer_q.setStyle({position:'absolute',display:'none'}).appear();$('is_new_question_'+qid).remove();if(!response.viewer.skipped)
this.incrementQuestionCounts(response.viewer.is_public);this.checkProgress.bind(this,response).delay(1.7);}
else{this.updateQuestionRow(response,qid);}}
else{this.showError(response,qid,new_question);}},submitAnswer_failure:function(transport,qid,new_question){alert('the ajax request failed');},showNextQuestion:function(){new Ajax.Request('/questions',{parameters:{next_question:1,questions_answered:this.questions_answered},onSuccess:this.showNextQuestion_cb.bindAsEventListener(this),onFailure:this.showNextQuestion_failure.bindAsEventListener(this)});},showNextQuestion_cb:function(transport){var response=transport.responseText.evalJSON();var new_q_wrapper=$('new_question');var new_q=new_q_wrapper.down('.question_wrap');if(!new_q)
new_q=new_q_wrapper.down('.question');new_q_wrapper.setStyle({height:new_q_wrapper.getHeight()+'px'});new_q.remove().setStyle({position:'absolute',top:new_q_wrapper.offsetTop+'px'});new_q_wrapper.insert({after:new_q});new_q.fade({duration:0.25});if(response.next_question){new_q_wrapper.update(response.next_question);var newer_q=new_q_wrapper.down('.question_wrap');if(!newer_q)
newer_q=new_q_wrapper.down('.question');}
else{$('questions_warning_comment').update(this.warnings.no_more_questions);new_q_wrapper.update($('questions_warning').remove().show());var newer_q=new_q_wrapper.down('.sr_message');}
newer_q.setStyle({position:'absolute',display:'none'}).appear({duration:0.25});setTimeout(function(response,new_q_wrapper,new_q,newer_q){new_q.remove();newer_q.setStyle({position:''});new_q_wrapper.morph({height:newer_q.getHeight()+'px'},{duration:0.25});setTimeout(function(new_q_wrapper){new_q_wrapper.setStyle({height:'auto'});this.refreshAds();}.bind(this,new_q_wrapper),350);}.bind(this,response,new_q_wrapper,new_q,newer_q),350);},showNextQuestion_failure:function(transport){alert('The ajax request failed');},updateQuestionRow:function(response,qid){if(response.viewer.skipped){$('question_'+qid).writeAttribute('class','');$('question_'+qid).addClassName('question self not_answered clearfix');$('reanswering_'+qid).value=1;}
else{$('question_'+qid+'_answer').value=response.viewer.answer;$('question_'+qid+'_match_answers').value=response.viewer.match_answers;$('question_'+qid+'_importance').value=response.viewer.importance;if(response.viewer.is_public){this.publicizeQuestion(response,qid);}
else{this.privatizeQuestion(response,qid);}
if(this.m_self_view){this.updateAnswers(response,qid);$('importance_bar_'+qid).select('div.block').each(function(div){div.remove();});$('importance_bar_'+qid).innerHTML+=$R(1,(6-response.viewer.importance)).collect(function(){return'<div class="block"></div>';}).join('');}
else{$('answer_viewer_'+qid).update($F('question_'+qid+'_qans'+response.viewer.answer));}
if($('reanswer_btn_'+qid))$('reanswer_btn_'+qid).remove();$('question_'+qid).addClassName('cant_reanswer');$('reanswering_'+qid).value=1;$('cant_reanswer_'+qid).show();$('error_'+qid).hide();}},incrementQuestionCounts:function(is_public){this.questions_answered++;this.questions_public+=is_public?1:0;this.updateQuestionCounts();this.questionCountActions();},updateQuestionCounts:function(){var old_match=$('q_possible_match').innerHTML;var possible_match=0;if(this.questions_answered>0){possible_match=util.roundNumber((1-1/this.questions_answered)*100,2);}
$('q_possible_match').update(possible_match);$('q_num_total').update(this.questions_answered);$('q_num_public').update(this.questions_public);if(old_match==possible_match.toString())
return;$('match_text').select('p').invoke('setStyle',{color:'#f83265'});setTimeout(function(){$('match_text').select('p').invoke('morph',{color:'#777'});},2000);},questionCountActions:function(){switch(this.questions_answered){case 25:if($('site_nav_menu_2')){$('site_nav_menu_2').select('li').last().show();}
break;}},checkProgress:function(response){if(this.questions_answered>50){if(this.consecutive_irrelevants>0){this.consecutive_irrelevants=0;AjaxSookie.update('consecutive_irrelevants',0,'1000','29f8c18f4cd3c16839c638285ce676d38ae87ad2');}
return;}
if(response.viewer.importance==5)
this.consecutive_irrelevants++;else
this.consecutive_irrelevants=0;AjaxSookie.update('consecutive_irrelevants',this.consecutive_irrelevants,'1814400','29f8c18f4cd3c16839c638285ce676d38ae87ad2');if(this.consecutive_irrelevants>=5){this.showPageWarning(this.warnings.consecutive_irrelevants);}},adjustQuestions:function(){if(this.questions_loaded<=10)
return;var questions=$$('#questions div.question:not([class*="not_answered"])');if(questions.length>11){var last_question=questions.last().fade({afterFinish:function(effect_event){effect_event.element.remove();}});}},refreshAds:function(){var ads=['skyscraper_floater_region','skyscraper_floater_region2'];for(var i=0;i<ads.length;i++){var ad=$(ads[i]);if(ad){ad.update(ad.innerHTML);}}},showPageWarning:function(text){var questions=$('questions');questions.setStyle({minHeight:questions.getHeight()+'px'});this.hideables=[questions.select('div.sr_message:not([id*=warning])'),questions.select('div.question'),questions.select('div.pages'),$$('.big_dig .right .bottom_pad'),$$('.big_dig .right .search'),$$('.big_dig .right .self_options')].flatten();this.hideables.each(function(hideable){if(hideable.visible())
hideable.fade({duration:0.25});});setTimeout(function(text){$('questions_warning_comment').update(text);$('questions_warning').appear({duration:0.25});}.bind(this,text),500);},hidePageWarning:function(){var warnings=$('questions').select('div.sr_message[id*=warning]');warnings.each(function(warning){if(warning.visible())
warning.fade({duration:0.25});});this.consecutive_irrelevants=0;AjaxSookie.update('consecutive_irrelevants',0,'1814400','29f8c18f4cd3c16839c638285ce676d38ae87ad2');setTimeout(function(){this.hideables.each(function(hideable){if(!hideable.visible())
hideable.appear({duration:0.25});});}.bind(this),500);},publicizeQuestion:function(response,qid){if(!this.m_self_view){$('answer_target_'+qid).update($F('question_'+qid+'_qans'+response.target.answer));if(response.target.note)$('note_target_'+qid).update(response.target.note.gsub('\n','<br/>')).show();if(response.viewer.note){$('note_viewer_'+qid).update(response.viewer.note.gsub('\n','<br/>')).show();$('add_or_edit_'+qid).update('Edit your');}
else{$('note_viewer_'+qid).update().hide();$('add_or_edit_'+qid).update('Add an');}
var what_target_wants=(response.target.match_answers).bitmaskToSet(5),target_accepts=false;var what_viewer_wants=(response.viewer.match_answers).bitmaskToSet(5),viewer_accepts=false;if(what_target_wants.length&&!what_target_wants.include(response.viewer.answer)){$('answer_viewer_'+qid).addClassName('not_accepted');}
else{target_accepts=true;$('answer_viewer_'+qid).removeClassName('not_accepted');}
if(what_viewer_wants.length&&!what_viewer_wants.include(response.target.answer)){$('answer_target_'+qid).addClassName('not_accepted');}
else{viewer_accepts=true;$('answer_target_'+qid).removeClassName('not_accepted');}
if(target_accepts&&viewer_accepts)
$('question_'+qid).addClassName('talk');else
$('question_'+qid).removeClassName('talk');}
else if(response.viewer.note){$('explanation_'+qid).update(response.viewer.note);$('note_'+qid).value=response.viewer.note;$('add_or_edit_'+qid).update('Edit your');}
else{$('explanation_'+qid).update();$('add_or_edit_'+qid).update('Add an');}
$('explain_'+qid).show();$('public_'+qid).checked=true;$('public_wrap_'+qid).hide();$('question_'+qid).removeClassNames(['not_answered','answering','not_public','reanswering']).addClassName('public');},privatizeQuestion:function(response,qid){if(!this.m_self_view){$('answer_target_'+qid).update('Answer publicly to see my public answer').removeClassName('not_accepted');$('answer_viewer_'+qid).removeClassName('not_accepted');}
$('question_'+qid).removeClassNames(['not_answered','answering','public','reanswering']).addClassName('not_public');},updateAnswers:function(response,qid){var answer=response.viewer.answer;var matchanswers=response.viewer.match_answers.bitmaskToSet(5);var importance=response.viewer.importance;for(var i=1;li=$('self_answers_'+qid+'_'+i);i++){i==answer?li.addClassName('mine'):li.removeClassName('mine');matchanswers.include(i)||importance==5?li.addClassName('match'):li.removeClassName('match');}},showError:function(response,qid,new_question){var e='Unknown error';var show_skip=false;switch(response.status){case 1:e='Status failure';break;case 2:e='You forgot to answer the question!';break;case 3:e='You need to select an importance.';break;case 4:e='Please select which answers you&rsquo;ll accept.';break;case 5:e='All match answers';break;case 6:e='This question was answered too recently.  Wait at least 1 day.';show_skip=new_question;break;case 7:e='You made this question public too recently.  Wait at least 1 day.';break;}
if(show_skip){e+='<br/><a href="#" onclick="BigDig.showNextQuestion(); return false;">Next question.</a>';}
$('error_'+qid).update(e).showOrPulse();},checkMatchAnswers:function(qid){var i,input,irrelevant=$('importance_'+qid+'_5'),match_answers=$('answer_'+qid).getValues('their_answer');$('irrelevant_'+qid).hide();for(i=1;i<=5;i++){input=$('importance_'+qid+'_'+i);if(input.disabled){input.enable();$(input.parentNode).removeClassNames(['disabled','removed']);}}
if(!match_answers){irrelevant.checked=true;}
else if(match_answers.length==$('answer_'+qid).select('input.their_answer').length){irrelevant.checked=true;for(i=1;i<=4;i++){input=$('importance_'+qid+'_'+i);input.disable();$(input.parentNode).addClassName('removed');}
$('irrelevant_'+qid).show();}
else{irrelevant.disable();irrelevant.checked=false;$(irrelevant.parentNode).addClassName('disabled');}
this.checkForm(qid);},checkForm:function(qid){var my_answer=$('answer_'+qid).getValues('my_answer');var match_answers=$('answer_'+qid).getValues('their_answer');var importance=$('answer_'+qid).getValues('importance');if(my_answer&&importance&&(match_answers!=null||importance==5)&&$('submit_btn_'+qid)){$('submit_btn_'+qid).removeClassNames(['gray','gray']).addClassName('green');}
else if($('submit_btn_'+qid)){$('submit_btn_'+qid).removeClassNames(['green','green']).addClassName('gray');}},talkAboutIt:function(qid,theirscreenname){var subject=escape('Our answers to "'+$('qtext_'+qid).innerHTML.substr(0,28)+'..."');var qtext=escape($('qtext_'+qid).innerHTML);var destination='/mailbox?compose=1&r1='+theirscreenname+'&subject='+subject+'&qtext='+qtext+'&talk=1';location.href=destination;},search:function(screenname){var destination='/profile/'+screenname+'/questions?search='+$F('input_question_search');destination+=this.m_show_all==1?'&show_all=1':'';location.href=destination;},setImportance:function(qid,importance){if($F('question_'+qid+'_importance')==5){this.toggleAnswer(qid,true);return;}
$('importance_bar_'+qid).addClassName('opacity_50');new Ajax.Request('/questions/ask',{parameters:{ajax:1,change_importance:1,qid:qid,importance:importance},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(!response.status){$('question_'+qid+'_importance').value=importance;$('importance_bar_'+qid).select('div.block').each(function(el){el.remove();});for(var i=0,res='';i<(5-importance+1);i++){res+='<div class="block"></div>';}
$('importance_bar_'+qid).insert({bottom:res});$('importance_'+qid+'_'+importance).checked=true;if(importance==5){$('self_answers_'+qid).select('li').each(function(li){li.addClassName('match');});BigDig.clearMatchAnswers(qid);}}
else{$('error_'+qid).update('Sorry, something went wrong.').showOrPulse();}
$('importance_bar_'+qid).removeClassName('opacity_50');}});},allPublic:function(){$('all_public_note').update('Making public...');$('all_public_loader').show();$('all_public_btn','all_public_cancel_btn').invoke('hide');new Ajax.Request('/questions',{parameters:{ajax:1,all_public:1},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(!response.status){$('all_public_note').update('Done!');$('all_public_loader').hide();location.href='/questions?go_public_success=1';}
else{$('all_public_btn','all_public_loader').invoke('hide');$('all_public_note').update('Sorry, there was an error.  Please try again later.');}}});},clearAll:function(){$('clear_all_note').update('Clearing...');$('clear_all_loader').show();$('clear_all_buttons').hide();$('clear_all').submit();},deleteQuestion:function(qid){if(confirm('Are you sure you want to delete this question?')){new Ajax.Request('/questions',{parameters:{ajax:1,delete_question:1,qid:qid},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(!response.status){$('question_'+qid).fade();}
else{$('error_'+qid).update('The question could not be deleted.').showOrPulse();}}});}},editNote:function(qid){$('explanation_'+qid,'explanation_edit_'+qid).invoke('toggle');if(this.m_self_view)
$('note_'+qid).value=$('explanation_'+qid).innerHTML.gsub(/<br\/?>/i,'\n');else{$('question_'+qid).toggleClassName('editing_note');$('note_viewer_'+qid).toggle();$('note_'+qid).value=$('note_viewer_'+qid).innerHTML.gsub(/<br\/?>/i,'\n');}
this.sizeNoteField($('note_'+qid),qid);},toggleNote:function(input,qid){if(input.checked){$('explain_wrap_'+qid).hide();$('gopublic_'+qid).show();$('public_'+qid).value="off";}else{$('explain_wrap_'+qid).show();$('gopublic_'+qid).hide();$('public_'+qid).value="on";}},sizeNoteField:function(textarea,qid){textarea.setStyle({height:'0px'});var default_height=parseInt(textarea.getStyle('line-height'))*2;if(textarea.scrollHeight<default_height)
textarea.setStyle({height:default_height+'px'});else
textarea.setStyle({height:textarea.scrollHeight+'px'});},saveNote:function(qid){if($('save_note_'+qid).hasClassName('gray'))
return;else
$('save_note_'+qid).removeClassName('green').addClassName('gray');var pass=this;var note=$F('note_'+qid);var prev_note=$('explanation_'+qid).innerHTML;new Ajax.Request('/questions/ask',{parameters:{ajax:1,qid:qid,note:(note.blank()&&!prev_note.blank())?'delete':note,delete_note:(note.blank()&&!prev_note.blank())?1:0},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response.note_status){if(pass.m_self_view)
$('explanation_'+qid).update(note.gsub('\n','<br/>'));else
$('note_viewer_'+qid).update(note.gsub('\n','<br/>')).hide();if(!note.blank())
$('add_or_edit_'+qid).update('Edit your');else
$('add_or_edit_'+qid).update('Add an');$('answer_'+qid+'_note').value=note;pass.editNote(qid);}
$('save_note_'+qid).removeClassName('gray').addClassName('green');}});},campaigns:{},hasSponsorship:function(qid){if(!this.campaigns[qid]||!$('question_'+qid))return false;if(!$(document.body).hasClassName('takeover_question'))return false;return true;},toggleSponsorship:function(qid){if(!this.hasSponsorship(qid))return;$('question_'+qid).addClassName('superquestion');if(!$('question_'+qid).down('.superlink')){var html='';html+='<a class="superlink" target="_blank" onclick="';html+="util.updateStats('";html+=this.campaigns[qid].click;html+="', 1, 'counter', '";html+=this.campaigns[qid].clickhash;html+="');";html+='" href="';html+=this.campaigns[qid].link;html+='"></a>';if(this.campaigns[qid].extra)html+=this.campaigns[qid].extra;$('question_'+qid).insert({bottom:html});util.updateStats(this.campaigns[qid].view,1,'counter',this.campaigns[qid].viewhash);}},submitSponsorshipAnswers:function(qid){if(!this.hasSponsorship(qid))return;$('question_'+qid).removeClassName('superquestion');if(typeof this.campaigns[qid]!='undefined'){}}});Number.prototype.bitmaskToSet=function(length){var set=[];for(var i=1;i<=length;i++){if((this>>i)&1==1)
set.push(i);}
return set;}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/service/profile.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/service/profile.js";
			
Number.prototype.roundTo=function(n){return(this*Math.pow(10,n)).round()/Math.pow(10,n);};Array.prototype.toTextList=function(usernames){for(var i=0,res='';i<this.length;i++){if(usernames)
res+='<a href="/profile/'+this[i]+'">'+this[i]+'</a>';else
res+=this[i];if(this.length>1&&i<this.length-2)
res+=', ';else if(this.length>1&&i<this.length-1)
res+=' and ';}
return res;};String.prototype.stripTagsAndHtml=function(){return this.replace(/(<<)|(>>)|(\[\[)|(\]\])/ig,'').stripTags();};Object.extend(Element.Methods,{turnOn:function(element){if(!element.hasClassName('green')){var link=element.select('a').first();var onclick=element.select('input').first().getAttribute('onclick');link.writeAttribute('onclick',onclick);}
return element.removeClassName('gray').addClassName('green');},turnOff:function(element,force){if(!element.hasClassName('gray')||force){var link=element.select('a').first();var inputs=element.select('input');if(!inputs.length){var onclick=link.getAttribute('onclick');element.insert({top:new Element('input',{type:'hidden',value:'',onclick:onclick})});}
link.writeAttribute('onclick','return false;');}
return element.addClassName('gray').removeClassName('green');}});Element.addMethods();var Profile={screenname:null,userid:null,myuserid:null,self_view:false,wiki_edits:null,settings_drag:null,window_open:false,gentations:{"40":"Girls who like girls","63":"Everybody","4":"Gay guys only","42":"Girls","54":"Guys and girls who like bi guys","1":"Straight guys only","16":"Bi guys only","57":"Guys and girls who like bi girls","2":"Straight girls only","17":"Guys who like girls","34":"Girls who like guys","32":"Bi girls only","21":"Guys","20":"Guys who like guys","8":"Gay girls only"},gender_short:{"M":"M","1":"M","0":"?","F":"F","2":"F"},orient_full:{"1":"Straight","0":"Unknown","3":"Bisexual","2":"Gay"},relstatus:{"1":"Single","0":"Unknown","3":"Married","2":"Seeing someone","4":"Available"},ethnicities:{"7":"Hispanic / Latin","6":"Pacific Islander","1":"Asian","3":"Black","10":"Undeclared","2":"Middle Eastern","9":"Other","8":"White","5":"Indian","4":"Native American"},lookingfor:{"6":"Casual sex","1":"New friends","0":"&mdash;","3":"Short-term dating","2":"Long-term dating","5":"Long-distance penpals","4":"Activity partners"},smoking:{"1":"Yes","0":"&mdash;","3":"When drinking","5":"No","2":"Sometimes","4":"Trying to quit"},drinking:{"6":"Not at all","1":"Very often","0":"&mdash;","3":"Socially","2":"Often","5":"Desperately","4":"Rarely"},drugs:{"1":"Sometimes","0":"Never","3":"&mdash;","2":"Often"},religion:{"7":"Islam","6":"Catholicism","1":"&mdash;","3":"Atheism","10":"Other","2":"Agnosticism","9":"Buddhism","8":"Hinduism","5":"Judaism","4":"Christianity"},religionserious:{"1":"and very serious about it","0":"","3":"but not too serious about it","2":"and somewhat serious about it","4":"and laughing about it"},sign:{"5":"Gemini","4":"Taurus","7":"Leo","6":"Cancer","1":"Aquarius","0":"&mdash;","3":"Aries","2":"Pisces","10":"Scorpio","11":"Sagittarius","12":"Capricorn","9":"Libra","8":"Virgo"},signstatus:{"1":"but it doesn&rsquo;t matter","0":"","3":"and it&rsquo;s fun to think about","2":"and it matters a lot"},education:{"7":"Ph.D program","6":"med school","1":"high school","0":"&mdash;","3":"college/university","2":"two-year college","8":"space camp","5":"law school","4":"masters program"},educationstatus:{"1":"Graduated from","0":"","3":"Dropped out of","2":"Working on"},job:{"18":"Unemployed","19":"Other","5":"Computer / Hardware / Software","4":"Clerical / Administrative","7":"Education / Academia","6":"Construction / Craftsmanship","1":"Student","14":"Political / Government","0":"&mdash;","15":"Sales / Marketing / Biz Dev","3":"Banking / Financial / Real Estate","16":"Science / Tech / Engineering","2":"Artistic / Musical / Writer","17":"Transportation","10":"Hospitality / Travel","11":"Law / Legal Services","12":"Medicine / Health","21":"Retired","13":"Military","9":"Executive / Management","20":"Rather not say","8":"Entertainment / Media"},income:{"5":"$50,000&ndash;$60,000","4":"$40,000&ndash;$50,000","7":"$70,000&ndash;$80,000","6":"$60,000&ndash;$70,000","1":"Less than $20,000","14":"Rather not say","0":"&mdash;","3":"$30,000&ndash;$40,000","2":"$20,000&ndash;$30,000","10":"$150,000&ndash;$250,000","11":"$250,000&ndash;$500,000","12":"$500,000&ndash;$1,000,000","13":"More than $1,000,000","9":"$100,000&ndash;$150,000","8":"$80,000&ndash;$100,000"},bodytype:{"5":"Average","4":"Skinny","7":"Athletic","6":"Fit","1":"Rather not say","0":"&mdash;","3":"Overweight","2":"Thin","10":"Curvy","11":"Full figured","12":"Used up","9":"A little extra","8":"Jacked"},children:{"6":"Doesn&rsquo;t have kids","1":"Has a kid","0":"&mdash;","3":"Likes children","2":"Has kids","5":"Doesn&rsquo;t want children","4":"Dislikes children"},children2:{"1":"Might want kids","0":"&mdash;","3":"Doesn&rsquo;t want kids","2":"Wants kids"},dogs:{"1":"Has dogs","0":"&mdash;","3":"Dislikes dogs","2":"Likes dogs"},cats:{"1":"Has cats","0":"&mdash;","3":"Dislikes cats","2":"Likes cats"},lang_list:[{"code":"en","name":"English","id":"74"},{"code":"af","name":"Afrikaans","id":"2"},{"code":"sq","name":"Albanian","id":"3"},{"code":"ar","name":"Arabic","id":"4"},{"code":"hy","name":"Armenian","id":"76"},{"code":"eu","name":"Basque","id":"5"},{"code":"be","name":"Belarusan","id":"6"},{"code":"bn","name":"Bengali","id":"7"},{"code":"br","name":"Breton","id":"8"},{"code":"bg","name":"Bulgarian","id":"9"},{"code":"ca","name":"Catalan","id":"10"},{"code":"11","name":"Cebuano","id":"11"},{"code":"ce","name":"Chechen","id":"12"},{"code":"zh","name":"Chinese","id":"13"},{"code":"71","name":"C++","id":"71"},{"code":"hr","name":"Croatian","id":"14"},{"code":"cs","name":"Czech","id":"15"},{"code":"da","name":"Danish","id":"16"},{"code":"nl","name":"Dutch","id":"17"},{"code":"eo","name":"Esperanto","id":"18"},{"code":"et","name":"Estonian","id":"19"},{"code":"20","name":"Farsi","id":"20"},{"code":"fi","name":"Finnish","id":"21"},{"code":"fr","name":"French","id":"22"},{"code":"23","name":"Frisian","id":"23"},{"code":"24","name":"Georgian","id":"24"},{"code":"de","name":"German","id":"25"},{"code":"el","name":"Greek","id":"26"},{"code":"gu","name":"Gujarati","id":"77"},{"code":"27","name":"Ancient Greek","id":"27"},{"code":"28","name":"Hawaiian","id":"28"},{"code":"he","name":"Hebrew","id":"29"},{"code":"hi","name":"Hindi","id":"75"},{"code":"hu","name":"Hungarian","id":"30"},{"code":"is","name":"Icelandic","id":"31"},{"code":"32","name":"Ilongo","id":"32"},{"code":"id","name":"Indonesian","id":"33"},{"code":"ga","name":"Irish","id":"34"},{"code":"it","name":"Italian","id":"35"},{"code":"ja","name":"Japanese","id":"36"},{"code":"37","name":"Khmer","id":"37"},{"code":"ko","name":"Korean","id":"38"},{"code":"la","name":"Latin","id":"39"},{"code":"lv","name":"Latvian","id":"40"},{"code":"72","name":"LISP","id":"72"},{"code":"lt","name":"Lithuanian","id":"41"},{"code":"ms","name":"Malay","id":"42"},{"code":"mi","name":"Maori","id":"43"},{"code":"mn","name":"Mongolian","id":"44"},{"code":"no","name":"Norwegian","id":"45"},{"code":"oc","name":"Occitan","id":"46"},{"code":"73","name":"Other","id":"73"},{"code":"fa","name":"Persian","id":"47"},{"code":"pl","name":"Polish","id":"48"},{"code":"pt","name":"Portuguese","id":"49"},{"code":"ro","name":"Romanian","id":"50"},{"code":"51","name":"Rotuman","id":"51"},{"code":"ru","name":"Russian","id":"52"},{"code":"sa","name":"Sanskrit","id":"53"},{"code":"54","name":"Sardinian","id":"54"},{"code":"sr","name":"Serbian","id":"55"},{"code":"1","name":"Sign Language","id":"1"},{"code":"sk","name":"Slovak","id":"56"},{"code":"sl","name":"Slovenian","id":"57"},{"code":"es","name":"Spanish","id":"58"},{"code":"sw","name":"Swahili","id":"59"},{"code":"sv","name":"Swedish","id":"60"},{"code":"tl","name":"Tagalog","id":"61"},{"code":"ta","name":"Tamil","id":"62"},{"code":"th","name":"Thai","id":"63"},{"code":"bo","name":"Tibetan","id":"64"},{"code":"tr","name":"Turkish","id":"65"},{"code":"uk","name":"Ukrainian","id":"66"},{"code":"ur","name":"Urdu","id":"67"},{"code":"vi","name":"Vietnamese","id":"68"},{"code":"cy","name":"Welsh","id":"69"},{"code":"yi","name":"Yiddish","id":"70"}],lang_codes:{},fluency:{"1":"Fluently","0":"","3":"Poorly","2":"Okay"},diet:{"6":"other","1":"anything","0":"&mdash;","3":"vegan","2":"vegetarian","5":"halal","4":"kosher"},dietserious:{"1":"Mostly","0":"","2":"Strictly"},is_sending:false,is_winking:false,actionbardisabled:false,actionbarthreshold:350,actionbartimer:null,messagewindowheight:179,minheight:57,maxheight:95,windowminheight:76,windowmaxheight:114,actionopenduration:0.15,actioncloseduration:0.15,minviewport:500,swapChildren:{0:['&mdash;','Might want kids','Wants kids','Doesn&rsquo;t want kids'],1:['&mdash;','and might want more','and wants more','but doesn&rsquo;t want more'],2:['&mdash;','and might want more','and wants more','but doesn&rsquo;t want more'],6:['&mdash;','but might want them','but wants them','and doesn&rsquo;t want any']},initialize:function(user_info,cgi_window,wiki_edits,accepted_wiki_notice,authcode,tracking_data,first_contact_time){this.screenname=user_info.screenname;this.userid=user_info.userid;this.myuserid=user_info.myuserid;this.self_view=(this.userid==CURRENTUSERID);this.accepted_wiki_notice=accepted_wiki_notice;this.authcode=authcode;this.tracking_data=tracking_data;this.first_contact_time=first_contact_time;this.is_fave=user_info.is_fave;this.is_alist=user_info.is_alist;this.setupEssayTitles();if(wiki_edits){this.wiki_edits={};for(var i=0;i<wiki_edits.length;i++){this.wiki_edits[wiki_edits[i].qnum-1]=wiki_edits[i];}}
for(var i=0;i<this.lang_list.length;i++){this.lang_codes[this.lang_list[i].code]=this.lang_list[i].name;}
if(cgi_window){this.loadWindow(cgi_window,'auto');}
else if(this.self_view&&!this.accepted_wiki_notice){this.loadWindow('edit_profile',225);}
DC.recordView(this.tracking_data);},setupEssayTitles:function(){this.essay_titles=['My self-summary','What Im doing with my life','Im really good at','The first things people usually notice about me','Favorite books, movies, shows, music, and food','The six things I could never do without','I spend a lot of time thinking about','On a typical Friday night I am','The most private thing Im willing to admit','You should message me if'];},mouseoverPhoto:function(){if(util.supportsTransitions()){$('profile_thumbs').addClassName('hovered');return;}
if($('thumb1'))new Effect.Morph('thumb1',{style:{left:'165px'},duration:0.20});if($('thumb2'))new Effect.Morph('thumb2',{style:{left:'330px'},duration:0.20});},mouseoutPhoto:function(){if(util.supportsTransitions()){$('profile_thumbs').removeClassName('hovered');return;}
if($('thumb1'))new Effect.Morph('thumb1',{style:{left:'0px'},duration:0.20});if($('thumb2'))new Effect.Morph('thumb2',{style:{left:'0px'},duration:0.20});},action:function(params,cb){params.ajax=1;new Ajax.Request('/profile',{parameters:params,onSuccess:cb});if(params.woo&&typeof LOTCC!="undefined"){LOTCC.bcpw("act","wink");}},toggleAd:function(action){var ad_container;if($('right_column')&&$('right_column').down('.frame_interior')){ad_container=$('right_column');}else if($('journal_ad')&&$('journal_ad').down('.frame_interior')){ad_container=$('journal_ad');}
if(action=='hide'&&ad_container){var ad=ad_container.down('.frame_interior');ad.remove();}},unblock_cb:function(response){switch(parseInt(response.responseText)){case 0:text="Unblocked";break;default:text="Error...";}
$('unblocker').innerHTML=text;},toggleFavorite:function(){var params={u:this.screenname};if(this.is_fave){params.removebuddy=1;}else{params.addbuddy=1;}
this.action(params,this.toggleFavorite_cb.bindAsEventListener(this));},toggleFavorite_cb:function(transport){var status=parseInt(transport.responseText,10),button=$('save_unsave');if(status!==0){return;}
if(this.is_fave){button.update('Save to Favorites');this.is_fave=false;util.updateStats('profile - removed from favorites',1,'counter','1JR3PkSNyEFMsundvyCe/9NtMvU=');}else{button.update('Remove Favorite');this.is_fave=true;util.updateStats('profile - saved to favorites',1,'counter','LLcn6AGRfjRwkHu2jXNDMOvgJY0=');}},woo_cb:function(response){switch(parseInt(response.responseText)){case 0:text="Successful wink!";util.updateStats('woo sent - successful',1,'counter','2r0oZ92fss4Z4ixGg1qROR1JnDU=');break;default:text="Couldn't wink for some reason. Sorry. Try later.";util.updateStats('woo sent - failure',1,'counter','Zzszhd1WPnZG4UM9ernvO3nGkjM=');}
if($('woo_close_')){$("woo_close_").innerHTML="Close";$("woo_text_").innerHTML=text;$("woo_submit_").hide();}
$("woo_text").innerHTML=text;$("woo_submit").hide();$("woo_close").innerHTML="Close";},visit:function(username){params={ajax:1,u:username,tuid:this.userid,stalk:1};new Ajax.Request('/profile',{parameters:params,onSuccess:this.visit_cb});},visit_cb:function(transport){util.updateStats('profile - alist browseanon - stalks',1,'counter','lVDDnnvTpce8UTFRcs9ibF5zm/g=');$('visit_button').hide();$('visit_button_success').show();},add_profile_share_stats:function(type){var name='profile - share - ';var hash='';switch(type){case"facebook":name+="facebook";hash="+0Vc1fLLV76LD2ggASwH0SNElZk=";break;case"twitter":name+="twitter";hash="rRrMB7TAAgOxAPJN6zpQTmMOWJs=";break;default:}
util.updateStats(name,1,"counter",hash);},shareOnFacebook:function(link){var attributes="width=625, height=400";var url='http://www.facebook.com/sharer.php?u='+link+'&t=Check+out+my+OkCupid+profile!';var newWindow=window.open(url,'Facebook',attributes);newWindow.focus;this.add_profile_share_stats('facebook');},shareOnTwitter:function(link){var twittermessage='Check out my OkCupid profile!';twittermessage=twittermessage.replace(/ /gi,"+");var twitterurl='http://www.twitter.com/share?url='+link+'&text='+twittermessage+'&via=OkCupid';var attributes="width=625, height=400";var newWindow=window.open(twitterurl,'Twitter',attributes);newWindow.focus;this.add_profile_share_stats('twitter');},blog_pop:function(post_id,dashified_title,board_id,pipe,username,uid,tuid,quotableContent,authcode){util.toggle("blogThis_"+post_id,false,false,1);invokeBlogThis($('hiddenTitleCopy'+post_id).innerHTML,quotableContent,'blogThis_'+post_id,uid,'/general_blogthis.html','board/blogthis_results.html',username,board_id,'/profile/'+username+'/journal/'+post_id+'/'+dashified_title,tuid,$('hiddenTitleCopy'+post_id).innerHTML,authcode);},profile_flag:function(response){if(response.status==200){s_message="Reported! Our moderators will look into this shortly. Thanks for helping OkCupid stay cool.";if(response.responseText.evalJSON().flagmod_eligible==1){s_message+=" <br/><br/>You know what's even cooler?  Helping OkCupid out by voting on flags set by other people.  You're currently eligible to be a flag moderator.  <a href='/flagmod'>Check out flagmod</a>.";}
$("flag_intro").innerHTML=s_message;$("flag_form").innerHTML=''
+'<p class="cancel">'
+'<a href="#CloseDialogue" onclick="javascript:util.toggle(\'flag_pop\',false,false,0,$(this).up(0));">Close</a>'
+'</p>';}},validateFlag:function(){$('descrip').show();$('flagcaveats').hide().immediateDescendants().invoke('hide');$('report_button').removeClassName('gray').addClassName('green');$('report_button').firstDescendant().setAttribute('onclick',"util.jackForm('flag_form','/flagmod',Profile.profile_flag); return false;");$('report_button').firstDescendant().onclick=function(){util.jackForm('flag_form','/flagmod',Profile.profile_flag);return false;};if($('flag_blank').checked){this.showFlagCaveat('blank');}else if($('flag_photo').checked){this.showFlagCaveat('photo');}},showFlagCaveat:function(type){if($('flagcaveat_'+type)){$('descrip').hide();$('flagcaveats').show();$('flagcaveat_'+type).show();$('report_button').removeClassName('green').addClassName('gray');$('report_button').firstDescendant().setAttribute('onclick',"return false;");$('report_button').firstDescendant().onclick=function(){return false;};}},picture_flag:function(which){$("flag_form_"+which).innerHTML=''
+'<p class="flag_intro">Reported!  Our moderators will look into this shortly.  Thanks for helping OkCupid stay cool.</p>'
+'<p class="cancel">'
+'<a href="#CloseDialogue" onclick="javascript:util.toggle(\'flag_pop_'+which+'\',false,false,0,$(this).up(0));">Close</a>'
+'</p>';},composeCheck:function(){if(!$('message_text'))return;var scrollheight=$('message_text').scrollHeight;var height=+($('message_text').style.height.replace('px',''));if($('message_filters')&&$('message_filters').visible()){var children=$('message_filters').immediateDescendants();scrollheight=0;for(var i=0;i<children.length;i++){scrollheight+=children[i].getDimensions().height;}}else{if(navigator.userAgent.toLowerCase().indexOf('safari')>0)scrollheight-=8;if(scrollheight<this.windowminheight)scrollheight=this.windowminheight;if(scrollheight>this.windowmaxheight)scrollheight=this.windowmaxheight;if(scrollheight>height){$('message_text').setStyle({height:scrollheight+'px'});}
if($F('message_text').length>10000){$('message_text').value=$F('message_text').substring(0,10000);$('message_text').scrollTop=10000000000;}}
var containerheight=scrollheight+103;if($('window_error')&&$('window_error').visible())
containerheight+=$('window_error').getHeight()+16;if(!$('message_success').visible()){$('shadowbox_content','shadowbox_loader').invoke('setStyle',{height:containerheight+'px'});}},sendMessage:function(sender){if(!$('message_text'))return;this.is_sending=true;sender=(sender=='actionbar')?'actionbar':'window';if($('message_text')&&$F('message_text').blank())
this.sendMessageSuccess(2,'');$('load_beaker').setStyle({marginTop:'-5px'});this.showSavingOverlay();if($('action_bar'))$('action_bar').removeClassName('active').addClassName('disabled');if($('save'))$('save').turnOff();var body=(sender=='window')?$F('message_text'):$F('action_message');var params={ajax:1,sendmsg:1,r1:this.screenname,subject:'',body:body,threadid:0,authcode:this.authcode,reply:0,from_profile:1};new Ajax.Request('/mailbox',{parameters:params,onSuccess:this.sendMessage_cb.bindAsEventListener(this,body,sender)});},sendMessage_cb:function(transport,body,sender){var response=transport.responseText.evalJSON(),query_params=window.location.href.toQueryParams();this.hideSavingOverlay();$('save').turnOn();$('shadowbox_content').down('div.buttons').show();if(this.sendMessageSuccess(response.status,body)){if($('window_error'))$('window_error').removeClassName('activated');this.showSuccessMatches();if($('action_error'))$('action_error').hide();if($('window_error'))$('window_error').hide();$('message_form').show();$('message_text').value='';$('message_text').setAttribute('style','');if($('action_message'))$('action_message').setAttribute('style','');this.syncMessage('window');if(this.is_winking){var stathash=(sender=='window')?'6FudcTtngURnIoX1WcY06o8zGp4=':'iJUGjVW/zXkTzRtvLXqcY3fLVLA=';util.updateStats('profile - wink sent',1,'counter','s4A2IVsC+Tgnppj+Sz2ExGJw8lM=');util.updateStats('profile - wink sent - '+sender,1,'counter',stathash);}
else{var stathash=(sender=='window')?'wFBTcJ1kSnH7OHz+Tlt0behLEy8=':'KLpDTdZHcjGM+C23wV5NZ9hxvY4=';util.updateStats('profile - message sent',1,'counter','4si2YmVcbmU4QcQtYmZn+Q4wTJg=');util.updateStats('profile - message sent - '+sender,1,'counter',stathash);if(this.stoplight_color){this.stoplight_color=this.stoplight_color.strip();switch(this.stoplight_color){case'red':util.updateStats('profile - messages sent - red stoplight',1,'counter','DNhxrlSBfzXwQS2eRrsiVTMhFkk=');break;case'yellow':util.updateStats('profile - messages sent - yellow stoplight',1,'counter','Lqs6gX4lxHk0qv4fGDIHEAKg16g=');break;case'green':util.updateStats('profile - messages sent - green stoplight',1,'counter','lYEQ3ZZQhkCN3aLri/n6JK+hDUc=');break;default:break;}}}
if(!this.first_contact_time){if(query_params.cf==='regular'||query_params.cf==='regular_indirect'){util.updateStats('profile - message sent - new contact - cf regular',1,'counter','EFgmWIQnLg6ZXBUgcNBmFvPma34=');util.updateStats('profile - message sent - new contact - cf regular - length',body.length,'value','7wfE9hLgThA3Y27AFB7H3AWzxe4=');}
util.updateStats('profile - message sent - new contact - length',body.length,'value','tCDXEq+85b5FT1QpDtvaOLDtXus=');this.storeMessageLength(body.length);this.first_contact_time=Math.floor(new Date().getTime()/1000);}
switch(query_params.cf){case'home_matches':util.updateStats('profile - messages sent - cf home matches',1,'counter','S39MpRRcytBEXIaXcy6z6wFSEEw=');break;case'home_visitors':util.updateStats('profile - messages sent - cf home visitors',1,'counter','9xKyOwEysohz29afxAans04D0RU=');break;case'visitors':util.updateStats('profile - messages sent - cf visitors',1,'counter','7EzpkEGxvw4WltCKCHg32qlnSJI=');break;case'home_matches_events':util.updateStats('profile - messages sent - cf home matches events',1,'counter','+TCzzKHekSDkR5b4A2Mcs/C3dh8=');break;case'home_orbits_events':util.updateStats('profile - messages sent - cf home orbits events',1,'counter','Irwk0el9p1wWmVU3dTdZT2oATcI=');break;case'home_visitors_events':util.updateStats('profile - messages sent - cf home visitors events',1,'counter','jM8sE2Zic838MuIqB8E/u3ZtUVc=');break;case'home_matches_events_wo':util.updateStats('profile - messages sent - cf home matches events wo',1,'counter','524pQFwvUjwIgOKgFOSXr03V030=');break;case'home_orbits_events_wo':util.updateStats('profile - messages sent - cf home orbits events wo',1,'counter','Mc0x+gmHHhBA+VE3qNoUbz+RiuQ=');break;case'home_visitors_wo':util.updateStats('profile - messages sent - cf home visitors events wo',1,'counter','8BISgsYdQhmN3IzFAxTmQQpL24Y=');break;case'recently_visited':util.updateStats('profile - messages sent - cf recently visited',1,'counter','mDlCRnE3ZEtpcareJse3MDA5GkY=');break;case'profile_similar':util.updateStats('profile - messages sent - cf profile similar',1,'counter','pt684ny+33LaX2GCdEzmZEjoljY=');break;case'favorites':util.updateStats('profile - messages sent - cf favorites',1,'counter','sZ6ccSBZMT9GLTaq5500cIduMXQ=');break;default:break;}
DC.recordMessage(this.tracking_data);}else if($('window_error')&&$('window_error').visible()){if($('continue'))$('continue').hide();if($('attach_btn'))$('attach_btn').show();$('save').show();if(!$('window_error').hasClassName('activated')){var height=$('shadowbox_content').getHeight();height+=50;$('shadowbox_content').setStyle({height:height+'px'});$('window_error').addClassName('activated');}
$('message_form').show();}
this.is_winking=false;this.is_sending=false;},storeMessageLength:function(count){new Ajax.Request('/messagelength',{parameters:{length:count},onSuccess:function(){}});},showSuccessMatches:function(){$('shadowbox_loader').hide();$('save').hide();$('cancel_a').update('Close');$('window_title').update('Success!');if($('attach_btn'))$('attach_btn').hide();if($('message_success')&&$('message_success_contents')){if($('message_success').hasClassName('borderless'))
$('settings').addClassName('borderless');$('seemore_btn').show();$('message_success').show();var height=$('message_success_contents').getHeight()+93;$('shadowbox_content').setStyle({height:height+'px'});var success_ad=$('success_ad');if(success_ad){success_ad.writeAttribute('src',success_ad.readAttribute('framesrc'));}}},sendMessageSuccess:function(status,body){var element=$('window_error');if(element){if(status!=4){element.removeClassName('giantmailbox');}
if(status!=3){element.removeClassName('oknotice').addClassName('oknotice_error');}
switch(status){case 2:element.update(body.blank()?'You can&rsquo;t send an empty message.':'Unknown error').show();break;case 3:return true;case 4:if(!element.hasClassName('giantmailbox'))
element.update('Your mailbox is full! You can&rsquo;t send messages.').show();break;case 5:if(!element.hasClassName('sendtofull'))
element.update('Receiver&rsquo;s mailbox is full! They can&rsquo;t receive messages.').show();break;case 11:element.update('You are trying to send the same message twice!').show();break;}}
return false;},fixSendBoxHeight:function(){if($('message_success')&&$('message_success').visible())return;var height=this.messagewindowheight;if($('window_error')&&$('window_error').visible()){height+=$('window_error').getHeight()+16;}
if(!$('message_text')){height-=86;}
$('shadowbox_content','shadowbox_loader').invoke('setStyle',{height:height+'px'});},actionSendMessage:function(){if(!$('action_bar')||!$('action_message'))return;this.toggleActionBar({forceclose:true});if($('message_form')){$('settings').show();Profile.settings_drag=new Draggable('settings',{handle:$('shadowbox_content').down('h3.title'),starteffect:null,endeffect:null,scroll:window});$('shadowbox_content').down('div.buttons').hide();$('message_form').hide();if($('message_filters'))$('message_filters').hide();this.positionWindow('send_message',this.messagewindowheight,true);this.actionSendMessage_cb();}
else{this.loadWindow('send_message',this.messagewindowheight,{cb:this.actionSendMessage_cb.bind(this),showsuccess:true});}},actionSendMessage_cb:function(sender){if(!$('action_bar'))return;$('message_form').hide();this.syncMessage('actionbar');this.sendMessage('actionbar');},toggleActionBar:function(params){var forceclose=(params&&params.forceclose)?true:false;var cb=(params&&params.cb)?params.cb:null;var cbduration=0.01;if(!forceclose){if(!$('action_bar')||$('action_bar').hasClassName('disabled')||this.is_sending||this.actionbardisabled)
return;}
var viewport=document.viewport.getDimensions().height;var scrolled=document.viewport.getScrollOffsets().top;if(scrolled>this.actionbarthreshold&&!$('action_bar').hasClassName('active')&&!forceclose&&viewport>this.minviewport){$('action_bar').addClassName('active');if($('message_form')&&$('message_text')){this.syncMessage('window');this.toggleMessageWindow('close');}
if(this.isActionMessageBlank()){$('action_compose').removeClassName('active');}else{$('action_compose').addClassName('active');}
this.showActionBar();cbduration+=this.actionopenduration;}else if(scrolled<=this.actionbarthreshold&&$('action_bar').hasClassName('active')||forceclose){if(forceclose){$('action_bar').hide();}else{$('action_bar').fade({duration:this.actioncloseduration});cbduration+=this.actioncloseduration;}
$('action_bar').removeClassName('active');this.syncMessage('actionbar');if($('action_message')&&!this.isActionMessageBlank()&&!forceclose){this.toggleMessageWindow('open');}}
if(cb)cb.delay(cbduration);},showActionBar:function(){var responseduration=this.actionopenduration+0.01;new Effect.SlideDown('action_bar',{duration:this.actionopenduration});this.actionComposeCheck.bind(this).delay(this.actionopenduration);if(GrazeCoverManager&&GrazeCoverManager.HighestKnownZIndex){if(+($('action_bar').style.zIndex)<GrazeCoverManager.HighestKnownZIndex+1){setTimeout(function(){$('action_bar').setStyle({zIndex:GrazeCoverManager.HighestKnownZIndex+1});},responseduration*1000);}}},isActionMessageBlank:function(){if(!$('action_bar')||!$('action_message'))return;if($F('action_message')=='')
return true;else
return false;},focusMessageCompose:function(winktype){if($('settings')&&$('settings').visible()&&$('message_success').visible()){this.closeWindow();}
if($('action_bar')&&$('action_bar').hasClassName('disabled')){$('action_bar').removeClassName('disabled').hide();}
if($('settings')&&$('settings').visible()&&$('message_text')){$('message_text').focus();return;}
var viewport=document.viewport.getDimensions().height;var scrolled=document.viewport.getScrollOffsets().top;if(!$('action_bar')||this.actionbardisabled||viewport<=this.minviewport||scrolled<=this.actionbarthreshold){this.toggleMessageWindow('open',winktype);util.reloadAds();}else{$('action_compose').addClassName('active');if($('action_bar').visible()){if($('action_message'))$('action_message').focus();}else{this.toggleActionBar({cb:function(){if($('action_message'))$('action_message').focus();}});}}},toggleMessageWindow:function(action,winktype,params){var cb=(params&&params.cb)?params.cb:null;var showsuccess=(params&&params.showsuccess)?params.showsuccess:null;if(action=='open'){if($('edit_notes_form'))this.closeWindow();if(!$('message_form')){$('shadowbox_content').hide();this.loadWindow('send_message',this.messagewindowheight,{cb:cb,showsuccess:showsuccess,winktype:winktype});}else{$('settings').show();this.syncMessage('actionbar');if(cb)cb();}}else if($('message_form')){$('settings').setStyle({top:'100px',left:''}).hide();}},syncMessage:function(sourcename){var source=(sourcename=='window')?$('message_text'):$('action_message');var dest=(sourcename=='window')?$('action_message'):$('message_text');if(source&&dest){dest.value=source.value;this.composeCheck();this.actionComposeCheck();}},toggleActionCompose:function(action){window.clearTimeout(this.actionbartimer);if(!$('action_bar'))return;if(action=='on'){$('action_compose').addClassName('active');if($('action_message'))$('action_message').focus();}else if(this.isActionMessageBlank()){$('action_compose').removeClassName('active');if($('action_message'))$('action_message').value='';}},actionComposeCheck:function(){if(!$('action_bar')||!$('action_message'))return;var scrollheight=$('action_message').scrollHeight;var height=+($('action_message').style.height.replace('px',''));if(navigator.userAgent.toLowerCase().indexOf('safari')>0)scrollheight-=6;if(scrollheight<this.minheight)scrollheight=this.minheight;if(scrollheight>this.maxheight)scrollheight=this.maxheight;if(scrollheight>height){$('action_message').setStyle({height:scrollheight+'px'});}
if($F('action_message').length>10000){$('action_message').value=$F('action_message').substring(0,10000);$('action_message').scrollTop=10000000;}},saveNotes:function(){var note=$F('note_text');new Ajax.Request('/vote_handler',{parameters:{voterid:CURRENTUSERID,target_userid:this.userid,type:'note',note:note},onSuccess:this.saveNotes_cb.bindAsEventListener(this,note)});},saveNotes_cb:function(transport,note){if($("inline_notes")){$('note_string').update(note.substr(0,75)+(note.length>75?'...':''));if(note.blank()){$('inline_notes').hide();if($('interests'))$('interests').show();}
else{$('inline_notes').show();if($('interests'))$('interests').hide();}}
Profile.closeWindow();},saveText:function(essay_id){this.self_view?this.saveEdit(essay_id):this.reviewWikiEdit(essay_id);},saveEdit:function(essay_id){$('save_edit_'+essay_id).turnOff();var new_text=$F('edit_'+essay_id);var old_text=$F('edit_copy_'+essay_id);var change_summary='[title:start]'+this.essay_titles[essay_id]+'[title:end]'+this.getChangeSummary(old_text,new_text);new Ajax.Request('/profileedit2',{parameters:{essay_body:new_text,essay_id:essay_id,change_summary:change_summary,okc_api:1,authcode:this.authcode},onSuccess:this.saveEdit_cb.bindAsEventListener(this,essay_id,new_text)});},saveEdit_cb:function(transport,essay_id,essay_text){var response=transport.responseText.evalJSON();if(response.errors.essay!='OK'){$('essay_'+essay_id+'_error').update(response.errors.essay).show();}
else{$('essay_text_'+essay_id).update(Profile.formatEssayText(essay_text));$('edit_copy_'+essay_id).value=essay_text;this.toggleEdit(essay_id);util.registerSuggestionActivity('edit_profile');}
$('save_edit_'+essay_id).turnOn();},toggleEdit:function(essay_id){var essay=$('essay_'+essay_id);if(essay.hasClassName('locked')&&!this.self_view){return false;}
else if(essay.hasClassName('locked')){this.selfReviewWikiEdit(essay_id);}
else if(!this.self_view&&!this.accepted_wiki_notice){this.loadWindow('suggest_edit',225,{essay_id:essay_id});}
else{essay.toggleClassName('saved').toggleClassName('editing');if(essay.hasClassName('editing'))
this.sizeEssayField('edit_'+essay_id);else
$('essay_'+essay_id+'_error').hide();}},cancelEdit:function(essay_id){this.toggleEdit(essay_id);$('edit_'+essay_id).value=$F('edit_copy_'+essay_id);},acceptWikiNote:function(essay_id){this.accepted_wiki_notice=true;if(this.self_view){AjaxSookie.set('accepted_self_wiki_notice',true,(3600*24*365*5),'44f355a0b44f9b1fd98326da9c0df5eb23644774');util.updateStats('profile - accepted self wiki notice',1,'counter','vYGlmzA9J04h9RQrFz2S/DEnEV0=');}
else{this.toggleEdit(essay_id);AjaxSookie.set('accepted_wiki_notice',true,(3600*24*365*5),'ef2a325515b1d35129ca23a62e0d336308905854');util.updateStats('profile - accepted wiki notice',1,'counter','UG/pl/i1PSm+DZYNtdkYIvFT2YE=');}
Profile.closeWindow();},sizeEssayField:function(textarea,lines,max_chars){textarea=$(textarea);if(max_chars&&textarea.value.length>max_chars)
textarea.value=textarea.value.substr(0,max_chars);var line_height=parseInt(textarea.getStyle('line-height'));var default_height=line_height*(lines||5);var max_height=line_height*22;var scroll_height=textarea.scrollHeight-parseInt(textarea.getStyle('paddingTop').replace('px',''))-parseInt(textarea.getStyle('paddingBottom').replace('px',''));if(scroll_height<default_height)
textarea.setStyle({height:default_height+'px'});else if(scroll_height<max_height)
textarea.setStyle({height:scroll_height+'px'});else
textarea.setStyle({height:max_height+'px'});},getEssayErrors:function(response,essay_id){var errors=[];for(var key in response.errors){if(response.errors[key]&&response.errors[key]=='OK'){$('error_'+key).hide();}
else if(response.errors[key]){errors.push(key);}}
return errors;},getChangeSummary:function(old_text,new_text){var types=['sub','keep','add'];old_text=old_text.stripTagsAndHtml();new_text=new_text.stripTagsAndHtml();var dmp=new diff_match_patch();var diffs=dmp.diff_main(old_text,new_text);dmp.diff_cleanupSemantic(diffs);var change_summary='';for(var i=0;i<diffs.length&&change_summary.length<800;i++){var res='';change_summary+='['+types[diffs[i][0]+1]+':start]'+this.possiblyCutText(diffs[i][1])+'['+types[diffs[i][0]+1]+':end]';}
return change_summary;},possiblyCutText:function(str){if(str.length>100){var snippet_length=100;var start=snippet_length/2;var end=str.length-start;var middle=str.substring(start,end);var pos1=start+middle.search(/\s/);var pos2=end-(middle.length-middle.search(/\s[^\s]*$/))+1;str=str.substring(0,pos1)+'...'+str.substring(pos2);}
return str;},formatEssayText:function(text){if(!text){text='<span class="empty">I&rsquo;m an empty essay... fill me out!</span>';}
else{text=text.gsub(/\n/,'<br/>').gsub(/<<(.*?)>>/,function(match){return'<a class="plink" href="/profile/'+match[1]+'">'+match[1]+'</a>';}).gsub(/\[\[(.*?)\]\]/,function(match){return'<a class="ilink" href="/interests?i='+match[1]+'">'+match[1]+'</a>';}).gsub(/<([a-z\/][^<>]*?)>/i,function(match){return'||'+match[1]+'||';}).gsub(/</,'&lt;').gsub(/>/,'&gt;').gsub(/\|\|([a-z\/][^>]*?)\|\|/i,function(match){return'<'+match[1]+'>';});}
return text;},reviewWikiEdit:function(essay_id){var types=[['<del>','</del>'],['',''],['<ins>','</ins>']];var dmp=new diff_match_patch();var old_text=$F('edit_copy_'+essay_id);var new_text=$F('edit_'+essay_id);var diff=dmp.diff_main(old_text,new_text,true);dmp.diff_cleanupSemantic(diff);var patch_list=dmp.patch_make(old_text,new_text,diff);var patch_text=dmp.patch_toText(patch_list);var diff_text='';for(var i=0;i<diff.length;i++){var res=(types[diff[i][0]+1][0]+diff[i][1].gsub(/<</,'&lt;&lt;')+types[diff[i][0]+1][1]);if(diff[i][0]!=-1)
res=res.gsub('\n','<br/>');diff_text+=res;}
this['essay_diff_'+essay_id]=diff_text;this['essay_patch_'+essay_id]=patch_text;this.loadWindow('wiki_review',null,{essay_id:essay_id,diff:diff_text});this.cancelEdit(essay_id);$('essay_'+essay_id).addClassName('locked');},saveWikiEdit:function(essay_id){$('save').turnOff();this.showSavingOverlay();var params={a:'submit_edits',ajax:1,note_to_user:$F('wiki_note'),owner:this.userid,rand:(Math.random()*100000000000).round()};if(this['essay_patch_'+essay_id].length>0)
params['essay'+(parseInt(essay_id)+1)]=this['essay_patch_'+essay_id];new Ajax.Request('/wikiprofile',{parameters:params,onSuccess:this.saveWikiEdit_cb.bindAsEventListener(this,essay_id)});},saveWikiEdit_cb:function(transport,essay_id){Profile.hideSavingOverlay();$('save').turnOn();var response=transport.responseText.evalJSON();if(response.success){$('essay_text_'+essay_id).update(this['essay_diff_'+essay_id]);$('edit_copy_'+essay_id).value=$F('edit_'+essay_id);Profile.toggleEdit(essay_id);Profile.closeWindow();$('essay_'+essay_id).addClassName('locked');util.updateStats('profile - wiki edit submitted',1,'counter','H/pKTScsxs6BZA8wkjd0HokrDC8=');}
else if(response.error=='no_edit'){$('window_error').update('There were no changes').show();}
else{$('window_error').update('Unknown error occurred').show();}},cancelWikiEdit:function(essay_id){Profile.closeWindow();$('essay_'+essay_id).removeClassName('locked');},selfReviewWikiEdit:function(essay_id){var user=this.wiki_edits[essay_id].editor_name;var titles=[];var edits=[];for(var edit in this.wiki_edits){if(this.wiki_edits[edit].editor_name==user){titles.push(this.essay_titles[this.wiki_edits[edit].qnum-1]);edits.push(this.getDiffTextFromEdit(this.wiki_edits[edit]));}}
this.loadWindow('wiki_edits',275,{editor:user,titles:titles,edits:edits});},getDiffTextFromEdit:function(wiki_edit){var essay_id=wiki_edit.qnum-1;var types=[['<del>','</del>'],['',''],['<ins>','</ins>']];var dmp=new diff_match_patch();var old_text=$F('edit_copy_'+essay_id).gsub(/\r/g,'');var patch_text=this.wiki_edits[essay_id].patch_text.gsub(/\r/g,'');var patches=dmp.patch_fromText(patch_text);var new_text=dmp.patch_apply(patches,old_text)[0];var diff=dmp.diff_main(old_text,new_text);dmp.diff_cleanupSemantic(diff);var diff_text='';for(var i=0;i<diff.length;i++){var res=(types[diff[i][0]+1][0]+diff[i][1].gsub(/<</,'&lt;&lt;')+types[diff[i][0]+1][1]);if(diff[i][0]!=-1)
res=res.gsub('\n','<br/>');diff_text+=res;}
new_text=new_text.gsub('\n','<br/>');wiki_edit.new_text=new_text;this.tidy(wiki_edit);return diff_text;},tidy:function(wiki_edit){new Ajax.Request('/tidy',{parameters:{text:wiki_edit.new_text,type:'profile'},onSuccess:this.tidy_cb.bindAsEventListener(this,wiki_edit)});},tidy_cb:function(transport,wiki_edit){var response=transport.responseText.evalJSON();response.text=response.text.gsub('<br />','');wiki_edit.new_text=response.text;},processWikiEdits:function(editor_name,accepted){for(var edit in this.wiki_edits){var wiki_edit=this.wiki_edits[edit];if(wiki_edit.editor_name==editor_name){new Ajax.Request('/wikiprofile',{parameters:{a:(accepted?'accept_edit':'reject_edit'),essay:wiki_edit.qnum,lang:'en',text:wiki_edit.new_text,rand:(Math.random()*100000000000).round()},onSuccess:this.processWikiEdit_cb.bindAsEventListener(this,(wiki_edit.qnum-1),wiki_edit,accepted)});}}
Profile.closeWindow();},processWikiEdit_cb:function(transport,essay_id,wiki_edit,accepted){var essay_id=wiki_edit.qnum-1;if(accepted){$('essay_text_'+essay_id).update(Profile.formatEssayText(wiki_edit.new_text));$('edit_'+essay_id).value=wiki_edit.new_text;$('edit_copy_'+essay_id).value=wiki_edit.new_text;util.updateStats('profile - wiki edit accepted',1,'counter','D1JuS3BWhhPaGtlsDSEiQs0xSIU=');}
else{util.updateStats('profile - wiki edit rejected',1,'counter','JCRsrVCIr0VQLUIuzQ6/g1lDn1U=');}
$('wiki_editor_'+wiki_edit.editor_name).remove();if(!$('wiki_editors').select('li').length)
$('wiki_editors').remove();$('essay_'+essay_id).removeClassName('locked');},positionWindow:function(box,height,forceopen){var v_offset=document.viewport.getScrollOffsets().top,sb_settings=$('settings'),sb_content=$('shadowbox_content'),sb_loader=$('shadowbox_loader'),sb_beaker=$('load_beaker'),sb_height=height?height:250,sb_min_height=250,sb_margin=0,sb_params={};if(sb_height==='auto'){sb_params.height=sb_height;sb_params.minHeight=sb_min_height+'px';sb_margin=(sb_min_height-140)/2;sb_content.addClassName('auto');}else{sb_params.height=sb_height+'px';sb_params.minHeight='0px';sb_margin=(sb_height-140)/2;sb_content.removeClassName('auto');}
sb_settings.setStyle({top:v_offset>91?v_offset+'px':'100px'});sb_beaker.setStyle({marginTop:forceopen?'-5px':sb_margin+'px'});$(sb_content,sb_loader).invoke('setStyle',sb_params);$(sb_settings,sb_loader).invoke('show');if(GrazeCoverManager.HighestKnownZIndex){if(parseInt(sb_settings.getStyle('zIndex'),10)<GrazeCoverManager.HighestKnownZIndex+1){sb_settings.setStyle({zIndex:GrazeCoverManager.HighestKnownZIndex+1});}}},loadWindow:function(box,height,params){var showsuccess=false,forceopen=false;if($('settings')&&!$('settings').visible()&&$('message_form')&&box=='send_message'){$('settings').show();return;}
if($('giant_mailbox_box')&&$('giant_mailbox_box').visible()){return;}
if($('send_to_full_box')&&$('send_to_full_box').visible()){return;}
if($('giant_mailbox_promo')&&box=='send_message'&&!Profile.purchased_giantmailbox){$('giant_mailbox_promo').show();util.verticallyCenter('giant_mailbox_promo');util.updateStats('giant_mailbox - profile promo - opens',1,'counter','UUrTspcykp2xU6pqDg4bp/k2xeY=');return;}
if($('send_to_full_promo')&&box=='send_message'&&!Profile.purchased_sendtofull){$('send_to_full_promo').show();util.verticallyCenter('send_to_full_promo');util.updateStats('send_to_full - profile promo - opens',1,'counter','Um/DrXTfyDq13ZjYFOJ2Ape8F3Q=');return;}
if($('mailbox_success')){$('mailbox_success').hide();}
if(!showsuccess&&(this.window_open||this.is_sending)){return;}
if(params&&params.showsuccess!=undefined){showsuccess=params.showsuccess;forceopen=true;delete params.showsuccess;}
if(params&&params.cb){var cb=params.cb;delete params.cb;}
if(params&&params.winktype){switch(params.winktype){case'wink':this.is_winking=true;break;default:break;}
delete params.winktype;}
this.positionWindow(box,height,forceopen);$('main_content').addClassName('no_ad');var pass=this;params=params||{};params.ajaxEdit=1;params.shadowbox=box;params.tuid=this.userid;new Ajax.Request('/profile',{parameters:params,onSuccess:this.loadWindow_cb.bindAsEventListener(this,params,cb,showsuccess)});this.window_open=true;},loadWindow_cb:function(transport,params,cb,showsuccess){if(!params.keep_loader)
$('shadowbox_loader').hide();else
$('shadowbox_loader').addClassName('saving');var viewport=document.viewport.getDimensions().height;$('shadowbox_content').update(transport.responseText).show();Profile.settings_drag=new Draggable('settings',{handle:$('shadowbox_content').down('h3.title'),starteffect:null,endeffect:null,scroll:window});if(viewport>this.minviewport&&$('action_bar')&&$('message_text')&&!showsuccess){this.syncMessage('actionbar');}
if(showsuccess){$('shadowbox_content').down('div.buttons').hide();if($('message_filters'))$('message_filters','continue').invoke('hide');}
if(cb)cb();},windowError:function(message){$('window_error').update(message).show();},closeWindow:function(){if(this.settings_drag)
this.settings_drag.destroy();if($('message_text'))this.syncMessage('window');$('shadowbox_content').update().hide();$('main_content').removeClassName('no_ad');if($('message_success'))$('message_success').hide();$('settings').hide().removeClassName('borderless');this.window_open=false;this.is_winking=false;},saveWindow:function(window_class){$('save').turnOff();this.showSavingOverlay();var params=this.getDifferences(window_class.m_window_data,$(window_class.m_form_id).serialize(true));params.okc_api=1;params.authcode=this.authcode;new Ajax.Request('/profileedit2',{parameters:params,onSuccess:this.saveWindow_cb.bindAsEventListener(this,window_class)});},saveWindow_cb:function(transport,window_class){this.hideSavingOverlay();$('save').turnOn();var response=transport.responseText.evalJSON();var errors=this.getWindowErrors(response);if(!errors.length){window_class.populate(transport);this.closeWindow();}
else{this.showWindowErrors(errors,window_class,response);}},showSavingOverlay:function(){$('shadowbox_loader').addClassName('saving').show();},hideSavingOverlay:function(){$('shadowbox_loader').removeClassName('saving').hide();},getDifferences:function(old,current){var diffs={};for(var key in current){if(typeof old[key]=='undefined'||!this.equal(old[key],current[key])){diffs[key]=current[key];}}
if(diffs.feet||diffs.inches){diffs.feet=current.feet||old.feet;diffs.inches=diffs.feet=='0'?0:current.inches||old.inches;}
if(typeof diffs.cont_lang_1!='undefined'||typeof diffs.cont_lang_2!='undefined'||typeof diffs.cont_lang_3!='undefined'||typeof diffs.cont_lang_4!='undefined'||typeof diffs.cont_lang_5!='undefined'||typeof diffs.language1status!='undefined'||typeof diffs.language2status!='undefined'||typeof diffs.language3status!='undefined'||typeof diffs.language4status!='undefined'||typeof diffs.language5status!='undefined'){for(var i=1;i<=5;i++){diffs['cont_lang_'+i]=current['cont_lang_'+i];diffs['language'+i+'status']=current['language'+i+'status'];}
diffs['cont_lang_1']='en';}
if(old.lookingfor||current.lookingfor){diffs.lookingfor=current.lookingfor||1;}
if(old.ethnicities&&!current.ethnicities){diffs.ethnicities='10';}
if(current.feet&&current.feet=='0'){current.inches=0;}
if(!diffs.locid){diffs.locid=current.locid;}
if(diffs.locid&&diffs.lquery){diffs.lquery='';}
if(diffs.new_uidal&&previous_usernames.include(diffs.new_uidal)){diffs.reactivate_uidal=BasicInfo.uidalToValue(diffs.new_uidal);diffs.new_uidal='';}
else if(diffs.new_uidal){diffs.reactivate_uidal='';}
if(diffs.children||diffs.children2){diffs.children=current.children;diffs.children2=current.children2;}
return diffs;},getWindowErrors:function(response){var errors=[];for(var key in response.errors){if(response.errors[key]&&response.errors[key]!='OK'){errors.push(key);}}
return errors;},showWindowErrors:function(errors,window_class,response){if(window_class.m_form_id==='basic_info_form'){for(var i=0;i<errors.length;i++){window_class.showWindowErrors(errors[i]);}}
else{var error_string='';for(var i=0;i<errors.length;i++){error_string+='<li>'+this.convertErrorText(errors[i]).capitalize()+'</li>';if(window_class['error_'+errors[i].toLowerCase()]){window_class['error_'+errors[i].toLowerCase()](response);}}
$('window_error').update('The following areas had errors: <ul>'+error_string+'</ul>').show();$(window_class.m_form_id).scrollTop=0;}},convertErrorText:function(error_text){var res=error_text;switch(error_text){case'uidal':res='Username';break;case'uidal_pw':res='Password';break;default:break;}
return res;},equal:function(a,b){if(a.constructor.toString().indexOf('Array')!=-1&&b.constructor.toString().indexOf('Array')!=-1&&a.length==b.length){for(var i=0;i<a.length;i++){if(!this.equal(a[i],b[i]))
return false;}
return true;}
else{return a==b;}},updateHeights:function(type){if(type=='english'){var feet=parseInt($F('feet'));var inches=parseInt($F('inches'));var cm=((feet*12+inches)*2.54).round();$('centimeters').value=(feet?cm:'');}
else{var cm=parseInt($F('centimeters'))||183;if(cm>241||cm<91)cm=183;var inches_total=(cm*0.3937).round();var feet=(inches_total/12).floor();var inches=inches_total%12;$('feet').value=feet;$('inches').value=inches;$('centimeters').value=cm;}},relStatusChange:function(select){select.value=='1'?$('marriage_alert').hide():$('marriage_alert').show();},lookingForCheck:function(){for(var i=2;i<=6;i++){if($('lookingfor_'+i).checked){$('lookingfor_1').disabled=false;$('lookingfor_label_1').removeClassName('disabled');return;}}
$('lookingfor_1').checked=true;$('lookingfor_1').disabled=true;$('lookingfor_label_1').addClassName('disabled');},attachPhotos:function(){var body_text;if($('action_bar')&&$('action_bar').hasClassName('active')&&$('action_message')){body_text=$F('action_message');}else{body_text=$F('message_text');}
util.postToUrl('/messages',{compose:1,r1:this.screenname,subject:'',body_text:body_text,attach:1});}};var BasicInfo={m_form_id:'basic_info_form',m_window_data:{},initialize:function(lquery){$('aso_loc').removeClassName('self');this.m_window_data=$(this.m_form_id).serialize(true);this.validateLocation();this.resetLocation();this.subscribeSave();},supports_oninput:('oninput'in document.createElement('input')),validateLocation:function(){var form=$(this.m_form_id),select=form.select('#country_select')[0],input=form.select('#zip_or_city')[0],lquery=$('lquery'),pquery=$('prev_lquery'),locid=$('locid'),plocid=$('prev_locid'),status=$('loc_status'),status_msg=status.select('p.message')[0],ajax_request=null;var is_zipcode=/^\d{5}$/,has_number=/\d/,has_letter=/[A-Za-z]/,has_punctuation=/[\/~!@#$%^&*"()_+={}?\.:;<>\\|\\[\]]/;function validateLocation_keyup(){var results=[],query_str='';results.push(lquery.value===pquery.value?false:true);if(select.value==='United States'){if(input.value.blank()){results.push(false);status.removeClassName('invalid').hide();input.removeClassName('invalid');}else{if(is_zipcode.match(input.value)){results.push(true);query_str=input.value;}else{results.push(false);if(has_letter.match(input.value)||has_punctuation.match(input.value)){status_msg.update('We couldn\'t understand your zip code!');status.addClassName('invalid').show();input.addClassName('invalid');}else if(input.value.length!=5){status_msg.update('Zip code must be 5 characters.');if(ajax_request){status.addClassName('invalid').show();input.addClassName('invalid');}else{status.removeClassName('invalid').hide();input.removeClassName('invalid');}}}}}else{if(input.value.blank()){results.push(false);status.removeClassName('invalid').hide();input.removeClassName('invalid');}else{if(has_number.match(input.value)||has_punctuation.match(input.value)){results.push(false);status_msg.update('We couldn\'t understand your city!');status.addClassName('invalid').show();input.addClassName('invalid');}else{results.push(true);query_str=input.value+', '+select.value;}}}
if(results.indexOf(false)===-1){if(ajax_request){ajax_request.abort();}
ajax_request=new Ajax.Request('/locquery',{parameters:{func:'query',query:query_str},onSuccess:this.validateLocation_keyup_cb.bindAsEventListener(this)});lquery.value=query_str;}else{lquery.value=$F(input);locid.value=plocid.value;}
input.fire('validation:change');}
function validateLocation_blur(){if(status.visible()){return;}
if(select.value==='United States'){if(input.value.blank()){if(is_zipcode.match(pquery.value)){input.setValue(pquery.value);lquery.setValue(pquery.value);}}else if(input.value.length!==5){status_msg.update('Zip code must be 5 characters.');status.addClassName('invalid').show();input.addClassName('invalid');}}else{if(input.value.blank()){var pq=pquery.value.split(',');if(pq.length>1){if(select.value.strip()===pq[pq.length-1].strip()){input.setValue(pq[0].strip());lquery.setValue(pquery.value);}}}else{new Ajax.Request('/locquery',{parameters:{func:'query',query:input.value+', '+select.value},onSuccess:this.validateLocation_blur_cb.bindAsEventListener(this)});}}
input.fire('validation:change');}
if(this.supports_oninput&&BrowserDetect.browser!=='Explorer'){input.observe('input',validateLocation_keyup.bind(this));}else{input.observe('keyup',validateLocation_keyup.bind(this));}
input.observe('blur',validateLocation_blur.bind(this));},validateLocation_keyup_cb:function(transport){var response=transport.responseText.evalJSON(),results=response.results,form=$(this.m_form_id),select=form.select('#country_select')[0],input=form.select('#zip_or_city')[0],status=$('loc_status'),status_msg=status.select('p.message')[0],lquery=$('lquery'),locid_input=$('locid'),is_zipcode=/^\d{5}$/;for(var i=0;i<results.length;i++){for(var j=i+1;j<results.length;j++){if(results[i].text===results[j].text){results.splice(j,1);j--;}}}
if(results.length){if(results.length>1){var cities=new Element('ul',{id:'cities'});for(var i=0;i<results.length;i++){cities.insert({bottom:'<li><a onclick="BasicInfo.updateLocation(\''+results[i].text+'\','+results[i].locid+');return false;">'+results[i].text+'</a></li>'});}
if(!input.value.empty()){input.addClassName('invalid');status_msg.update(cities).insert({top:'<span class="multi">Multiple matches found.</span><strong>Pick one:</strong>'});status.addClassName('invalid').show();}}else{if(!input.value.empty()){input.removeClassName('invalid');status_msg.update('Ahh, '+results[0].text+'.');status.removeClassName('invalid').show();locid_input.value=lquery.value.match(is_zipcode)?'':results[0].locid;}}}else{if(select.value==='United States'&&input.value.length===5){input.addClassName('invalid');status_msg.update('We couldn\'t find your city.');status.addClassName('invalid').show();}else{input.removeClassName('invalid');status.removeClassName('invalid').hide();}}
input.fire('validation:change');},validateLocation_blur_cb:function(transport){var response=transport.responseText.evalJSON(),results=response.results,input=$(this.m_form_id).select('#zip_or_city')[0],status=$('loc_status'),status_msg=status.select('p.message')[0];if(!results.length&&!input.value.empty()){status_msg.update('We couldn\'t find your city.');status.addClassName('invalid').show();input.addClassName('invalid');}
input.fire('validation:change');},updateLocation:function(city_name,locid){var input=$(this.m_form_id).select('#zip_or_city')[0],lquery=$('lquery'),locid_input=$('locid'),status=$('loc_status'),status_msg=status.select('p.message')[0];input.value=city_name;lquery.value=city_name;locid_input.value=locid;input.removeClassName('invalid');status.removeClassName('invalid');status_msg.update('Ahh, '+city_name);input.fire('validation:change');},resetLocation:function(){var select=$('country_select'),status=$('loc_status'),status_msg=status.select('p.message')[0],input=$('zip_or_city'),lquery=$('lquery'),pquery=$('prev_lquery'),label=$('location_label'),is_zipcode=/^\d{5}$/;select.observe('change',function(){input.removeClassName('invalid').setValue('');status.hide();status_msg.update();this.showLocation();if(select.value==='United States'){if(is_zipcode.match(pquery.value)){input.setValue(pquery.value);lquery.setValue(pquery.value);}
label.update('Zip code');}else{var pq=pquery.value.split(',');if(pq.length>1){if(select.value.strip()===pq[pq.length-1].strip()){input.setValue(pq[0].strip());lquery.setValue(pquery.value);}}
label.update('Your <em>City</em> in '+select.value+'');}
input.fire('validation:change');}.bind(this));},showLocation:function(){var edit=$('edit_basic_info_location'),location=$('basic_info_location');if(edit&&edit.visible()){edit.hide();location.show();}},typeUidal:function(input){var username=input.value,uidal=username.empty()?Profile.screenname:username;if($('prev_uidals')){$('prev_uidals').value='';}
this.checkUidalAvailability(uidal);},typePassword:function(input){var status=status=$('password_status'),status_msg=status.select('p.message')[0],save=$('save');input.removeClassName('invalid');status.hide();status_msg.update();save.turnOn();input.fire('validation:change');},selectUidal:function(select){var username=select.options[select.selectedIndex].text,userval=select.options[select.selectedIndex].value,uidal=userval.empty()?Profile.screenname:username;$('sn_chosen').value='';this.checkUidalAvailability(uidal);$('authorize_namechange').show();},checkUidalAvailability:function(uidal){var input=$('sn_chosen'),status=$('uidal_status'),status_msg=status.select('p.message')[0],authorize=$('authorize_namechange'),new_uidal=$('new_uidal');if(this.uidalCheck){this.uidalCheck.abort();}
new_uidal.value=uidal===Profile.screenname?'':uidal;if(uidal===Profile.screenname||previous_usernames.include(uidal)){authorize.addClassName('bad');input.removeClassName('invalid');status.removeClassName('invalid');if(input.value.empty()){status.hide();}else{status_msg.update('Something is very familar about that one.');status.show();}}
else if(uidal.length<4){if(this.uidalCheck){authorize.addClassName('bad');input.addClassName('invalid');status_msg.update('Sorry, <strong>'+uidal+'</strong> is too short.');status.addClassName('invalid').show();}}
else{this.uidalCheck=new Ajax.Request('/util/sncheck',{parameters:{un:uidal},onSuccess:this.checkUidalAvailability_cb.bindAsEventListener(this)});}
input.fire('validation:change');},checkUidalAvailability_cb:function(transport){var response=transport.responseText.evalJSON(),input=$('sn_chosen'),status=$('uidal_status'),status_msg=status.select('p.message')[0],authorize=$('authorize_namechange');if(response.ok){input.removeClassName('invalid');authorize.removeClassName('bad');if(Profile.is_alist){authorize.show();}
status.removeClassName('invalid').show();status_msg.update('Great! <strong>'+$F(input)+'</strong> is available!');}
else{input.addClassName('invalid');authorize.addClassName('bad');status.addClassName('invalid').show();switch(response.why){case'invalid':status_msg.update('Invalid screen name.');break;case'taken':status_msg.update('Sorry, <strong>'+$F(input)+'</strong> is unavailable.');break;default:break;}}
input.fire('validation:change');},checkUidalAvailability_blur:function(input){var status=$('uidal_status'),status_msg=status.select('p.message')[0];if(!input.value.empty()&&input.value.length<4){status_msg.update('Sorry, <strong>'+input.value+'</strong> is too short.');status.addClassName('invalid').show();input.addClassName('invalid').fire('validation:change');}},upgradeUsername:function(){if($('authorize_namechange').hasClassName('bad')){location.href='https://includes.okccdn.com/upgrade?cf=profile_username&feature=username';}else{location.href='https://includes.okccdn.com/upgrade?cf=profile_username&feature=username&un='+$F('new_uidal');}},uidalToValue:function(uidal){var prev_uidals=$('prev_uidals');for(var i=0;i<prev_uidals.options.length;i++){if(uidal==prev_uidals.options[i].text){return prev_uidals.options[i].value;}}
return uidal;},showWindowErrors:function(error){if(Profile.is_alist){switch(error){case'uidal_pw':var input=$('password'),status=$('password_status'),status_msg=status.select('p.message')[0];input.addClassName('invalid');status_msg.update(input.value.empty()?'We need your password!':'Incorrect password.');status.addClassName('invalid').show();input.fire('validation:change');$('authorize_namechange').show();break;case'location':var input=$('zip_or_city'),status=$('loc_status'),status_msg=status.select('p.message')[0];input.addClassName('invalid');status_msg.update('We couldn\'t find your city.');status.addClassName('invalid').show();input.fire('validation:change');break;default:break;}}
else{switch(error){case'uidal_pw':var input=$('sn_chosen'),status=$('uidal_status'),status_msg=status.select('p.message')[0];input.addClassName('invalid');status_msg.update('You must be A-List to edit your username.');status.addClassName('invalid').show();input.fire('validation:change');break;case'location':var input=$('zip_or_city'),status=$('loc_status'),status_msg=status.select('p.message')[0];input.addClassName('invalid');status_msg.update('We couldn\'t find your city.');status.addClassName('invalid').show();input.fire('validation:change');break;default:break;}}},subscribeSave:function(){var inputs=['sn_chosen','password','zip_or_city'],form=$(this.m_form_id),save=$('save');form.observe('validation:change',function(){var results=[];for(var i=0;i<inputs.length;i++){results.push($(inputs[i])&&$(inputs[i]).hasClassName('invalid')?false:true);}
if(results.indexOf(false)===-1){save.turnOn();}else{save.turnOff();}});},save:function(){Profile.saveWindow(this);},close:function(){$('aso_loc').addClassName('self');Profile.closeWindow();},populate:function(transport){var response=transport.responseText.evalJSON();var params=$(this.m_form_id).serialize(true);var age=((new Date()-new Date(params.birthyear,params.birthmonth-1,params.birthday))/1000/(86400*365)).floor();var loctext=response.loctext?response.loctext:$('ajax_location').innerHTML;$('ajax_age').update(age);$('ajax_gender').update(Profile.gender_short[params.gender]);$('ajax_orientation').update(Profile.orient_full[params.orientation]);$('ajax_status').update(Profile.relstatus[params['status']]);$('ajax_location').update(loctext);$('aso_loc').addClassName('self');if($('city_select')){$('zip_or_city').show();Element.remove('city_select');$('location_label').removeClassName('fix');}
if(params.new_uidal){$('user_nav_sn').update(params.new_uidal);$('basic_info_sn').update(params.new_uidal);util.updateStats('prok - username changed - profile',1,'counter','eJ+EquU8Nc9PE8iaJZPDQ/mE2ng=');}
util.updateStats('profile - updated basic info',1,'counter','7+k6R00TLIvLgxz8N8j1muw9xgA=');},togglePrivacy:function(){if($('orientation').value>1){$('gayprivacycheckbox').show();}else{$('gayprivacycheckbox').hide();$('gayprivacy').value=0;$('gayprivacy_switch').checked=false;}},togglePrivacyCheckbox:function(){$('gayprivacy').value=$('gayprivacy_switch').checked?1:0;}};var Details={m_form_id:'details_form',m_window_data:{},initialize:function(){$('skinny_wrap').removeClassName('self');this.m_window_data=$(this.m_form_id).serialize(true);this.toggleChildrenOptions();},save:function(){Profile.saveWindow(this);},close:function(){$('skinny_wrap').addClassName('self');Profile.closeWindow();},populate:function(transport){var params=$(this.m_form_id).serialize(true);if(typeof params.ethnicities!='object')params.ethnicities=[params.ethnicities];var ethnicities=params.ethnicities.collect(function(i){return Profile.ethnicities[i];}).join(', ')||'&mdash;';var height=params.feet==0?'&mdash;':params.feet+"' "+params.inches+'" ('+((parseInt(params.feet)*12+parseInt(params.inches))/39.37).roundTo(2)+'m)';var pets=(params.dogs!='0'?Profile.dogs[params.dogs]:'')+(params.dogs!='0'&&params.cats!='0'?' and ':'')+(params.cats!='0'?Profile.cats[params.cats]:'')||'&mdash;';var languages='English'+(params.language1status!='0'?' ('+Profile.fluency[params.language1status]+')':'');for(var i=1;i<=5;i++){if(params['cont_lang_'+i]){languages+=', '+Profile.lang_codes[params['cont_lang_'+i]];}
if(params['cont_lang_'+i]&&params['language'+i+'status']&&params['language'+i+'status']!='0'){languages+=' ('+Profile.fluency[params['language'+i+'status']]+')';}}
$('ajax_ethnicities').update(ethnicities);$('ajax_height').update(height);$('ajax_bodytype').update(Profile.bodytype[params.bodytype]);$('ajax_smoking').update(Profile.smoking[params.smoking]);$('ajax_drinking').update(Profile.drinking[params.drinking]);$('ajax_drugs').update(Profile.drugs[params.drugs]);$('ajax_religion').update(Profile.religion[params.religion]+' '+(params.religion!='1'?Profile.religionserious[params.religionserious]:''));$('ajax_sign').update(Profile.sign[params.sign]+' '+(params.sign!='0'?Profile.signstatus[params.sign_status]:''));$('ajax_education').update((params.educationlevel!='0'?Profile.educationstatus[params.educationstatus]:'')+' '+Profile.education[params.educationlevel]);$('ajax_job').update(Profile.job[params.job]);$('ajax_income').update(Profile.income[params.income]);if(params.children=='0'&&params.children2=='0'){$('ajax_children').update(Profile.children[params.children]);}else{if(params.children=='0'){$('ajax_children').update(Profile.children2[params.children2]);}else if(params.children2=='0'){$('ajax_children').update(Profile.children[params.children]);}else{$('ajax_children').update(Profile.children[params.children]);if((params.children=='1'||params.children=='2')&&params.children2=='3'){$('ajax_children').insert(", but "+Profile.children2[params.children2].toString().replace("kids","more").toLowerCase());}else if((params.children=='1'||params.children=='2')&&params.children2!='3'){$('ajax_children').insert(", and "+Profile.children2[params.children2].toString().replace("kids","more").toLowerCase());}else if(params.children=='6'&&params.children2=='3'){$('ajax_children').insert(", and "+Profile.children2[params.children2].toString().replace("kids","any").toLowerCase());}else if(params.children=='6'&&params.children2!='3'){$('ajax_children').insert(", but "+Profile.children2[params.children2].toString().replace("kids","them").toLowerCase());}}}
$('ajax_diet').update(Profile.dietserious[params.dietserious]+' '+Profile.diet[params.diet]);$('ajax_pets').update(pets);$('ajax_languages').update(languages);$('skinny_wrap').addClassName('self');util.updateStats('profile - updated details',1,'counter','EjlIgUjcb3wa/CndP4Bdp9CDnxU=');},toggleChildrenOptions:function(){var q1=$('children_select_question_one');var q2=$('children_select_question_two');var fill=Profile.swapChildren[q1.value];for(i=0;i<q2.options.length;i++)
{q2.options[i].update(fill[i]);}}};var WhatIWant={m_form_id:'what_i_want_form',m_window_data:{lookingfor:1},initialize:function(lquery,locid){$('what_i_want').addClassName('locked');},setAge:function(){var min=parseInt($F('age_min'))||18;if(min<18)min=18;if(min>99)min=99;var max=parseInt($F('age_max'))||min+1;if(max<=min)max=min+1;if(max>100)max=100;$('age_min').value=min;$('age_max').value=max;$('filter2').value='2,'+min+','+max;},setLoc:function(range){if(range=='anywhere'){$('filter3').value='3,0';}
else{$('filter3').value='3,25';}},save:function(){Profile.saveWindow(this);},close:function(){$('what_i_want').removeClassName('locked');Profile.closeWindow();},populate:function(transport){var params=$(this.m_form_id).serialize(true);var filter2=params.filter2.split(',');var singleness=parseInt(params.filter5.split(',').last());if(params.locid&&params.locid!='0'){var near='Near '+$F('lquery');}
else if(params.filter3&&params.filter3=='3,25'){var near='Near me';}
else{var near='Located anywhere';}
if(!params.lookingfor)params.lookingfor=[];else if(typeof params.lookingfor!='object')params.lookingfor=[params.lookingfor];var lookingfor='For '+(params.lookingfor.collect(function(i){return Profile.lookingfor[i].toLowerCase();}).join(', ')||'new friends');$('ajax_gentation').update(Profile.gentations[params.filter1.split(',').last()]);$('ajax_ages').update('Ages '+filter2[1]+'-'+filter2[2]);singleness?$('ajax_single').show():$('ajax_single').hide();$('ajax_near').update(near);$('ajax_lookingfor').update(lookingfor);$('what_i_want').removeClassName('locked');util.updateStats('profile - updated what i want',1,'counter','GYFmRsJsZt0FvQAim29r9kCzyXc=');}};var GiantMailboxFallback={check:function(){if(Profile.purchased_giantmailbox&&$('sendmsg_mailboxbtn')&&$('sendmsg_mailboxtext')){var button=$('sendmsg_mailboxbtn').down('a');button.setAttribute('onclick','GiantMailboxFallback.reload(); return false;');button.innerHTML='Try again';$('sendmsg_mailboxtext').update('Your account is updating. Try again in a sec!');util.updateStats('giant mailbox - profile - message box - bought but no giant mailbox',1,'counter','ESXpHhbM6ACTSqIalR0Atw9qPHo=');}},reload:function(){Profile.closeWindow();Profile.focusMessageCompose();}};var SendToFullFallback={check:function(){if(Profile.purchased_sendtofull&&$('sendmsg_sendtofullbtn')&&$('sendmsg_sendtofulltext')){var button=$('sendmsg_sendtofullbtn').down('a');button.setAttribute('onclick','SendToFullFallback.reload(); return false;');button.innerHTML='Try again';$('sendmsg_sendtofulltext').update('Your account is updating. Try again in a sec!');util.updateStats('send_to_full - profile - message box - bought but no giant mailbox',1,'counter','YpKy+vqa64qR38wKYX9bwmWYpb8=');}},reload:function(){Profile.closeWindow();Profile.focusMessageCompose();}};
			AUTOCORE_SELF_CHECK = null;
		
addNewCoresToCookie(["12", "15", "16", "26", "57", "66", "71", "96"], "d51b43fd");